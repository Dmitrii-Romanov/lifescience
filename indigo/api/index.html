<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>API</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    
    

    <link rel="stylesheet" href="../../_static/fonts/font-awesome/css/font-awesome.min.css"/>
    
    <link rel="icon" type="image/png" href="../../_static/images/icons/favicon-16.png">

    <!-- jQuery Core -->
    <script src="../../_static/js/lib/jquery-1.12.0.min.js"></script>

    <!--Sphinx files-->
    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    './',
            VERSION:     '0.3.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  false
        };
    </script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>

    

    <!-- Bootstrap Core -->
    <link rel="stylesheet" href="../../_static/bootstrap/css/bootstrap.min.css"/>
    <script src="../../_static/bootstrap/js/bootstrap.min.js"></script>

    <!-- EPAM UUI JavaScript Core -->
    <script src="../../_static/js/uui-core.min.js" type="text/javascript"></script>
    <script src="../../_static/js/uui-global-search.min.js" type="text/javascript"></script>

    <!-- EPAM UUI Styles Core -->
    <link rel="stylesheet" href="../../_static/css/uui-styles.css"/>

    <!-- Scroll for UUI Sidebar -->
    <link rel="stylesheet" href="../../_static/css/lib/jquery.mCustomScrollbar.min.css"/>
    <script src="../../_static/js/lib/jquery.mCustomScrollbar.concat.min.js"></script>

    <!-- Handlebars -->
    <script src="../../_static/js/handlebars.js"></script>

    <!-- Custom sidenav -->
    <script src="../../_static/js/custom-sidenav.js"></script>

    <!-- Pygments -->
    <link rel="stylesheet" href="../../_static/css/pygments.css"/>

    

    <script type="text/javascript">
        $(window).load(function () {
            //document.title = "API"
            UUI.Navigation.init();
            UUI.Global_Search.init();

            $('.news').height($('#main-tiles').height())
        });
    </script>
</head>

<body>
    
    <div class="wrapper">

        <header>
    <div class="uui-header">
        <nav>
            <!--Responsive html-layout-->
            <div class="uui-responsive-header">
                <div class="responsive-header">
                    <div class="responsive-toggle-box">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <div class="responsive-hide-menu">
                        <span></span>
                        <span></span>
                    </div>
                    <a href="../../index.html" class="responsive-brand-logo">
                        <span class="arrow fa fa-angle-left"></span>
                        <span class="logo">
                        <img src="../../_static/images/Logo_Epam_Color.svg" alt=""/>
                    </span>
                        <span class="title">Life Sciences</span>
                    </a>
                    <ul class="responsive-header-tools nav navbar-nav">
                        <li class="responsive-header-icon search-icon">
                            <a href="#" onclick="return false">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="responsive-menu">
                    <div class="menu-wrapper">
                        <div class="menu-scroll">
                            <ul class="nav navbar-nav">
                                <li class="sub-menu active">
                                    <a href="../../index.html">
                                        <span>Products</span>
                                        <div class="arrow fa fa-angle-right"></div>
                                    </a>
                                    

<ul class="sub">
<li class="sub-menu"><a class="reference internal" href="../../bingo/index.html">Bingo<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../bingo/bingo-oracle.html">Bingo Oracle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bingo/bingo-postgres.html">Bingo PostgreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bingo/bingo-sqlserver.html">Bingo SQL Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bingo/bingo-nosql.html">Bingo NoSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/bingo.html">Downloads</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../mri/index.html">Web3D DICOM Viewer<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../mri/papers.html">Research and Development</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../miew/index.html">Miew<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../miew/embed.html">Embedding the Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../miew/selectors.html">Selection Language</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../ngb/index.html">NGB</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Indigo Toolkit<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2 current"><a class="current reference internal" href="#">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html">Indigo Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/indigo/index.html">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build.html">Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html">SDK Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../options/index.html">Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/index.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../ketcher/index.html">Ketcher<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../ketcher/editing-tips.html">Editing Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ketcher/developers-manual.html">Developers Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ketcher/help.html">Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ketcher/demo.html">Ketcher 2.0 Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/ketcher.html">Downloads</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../eln/index.html">Indigo ELN<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../eln/changelog.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/indigo/eln.html">Downloads</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../imago/index.html">Imago OCR<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../imago/examples.html">Features and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/report.html">Comparison Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/imago-gui.html">Imago OCR Visual Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/imago_console.html">Imago Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/c.html">C Library Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/java.html">Java Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/dependencies.html">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../imago/changelog.html">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/imago.html">Downloads</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../parso.html">Parso<div class="arrow fa fa-angle-right"></div></a><ul class="sub">
<li class="toctree-l2"><a class="reference internal" href="../../parso/changelog.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../download/parso.html">Downloads</a></li>
</ul>
</li>
<li class="sub-menu"><a class="reference internal" href="../../selenium.html">Selenium Framework</a></li>
</ul>

                                </li>
                                <li><a href="../../resources.html"><span>Resources</span></a></li>
                                <li><a href="../../download/index.html"><span>Downloads</span></a></li>
                                <li><a href="../../contact.html"><span>Contact Info</span></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="responsive-global-search">
                    <div class="search-header">
                        <div class="header-wrapper">
                            <div class="search-field">
                                <label></label>
                                <form action="../../search.html" method="get">
    <input type="search" name="q" class="uui-search" placeholder="Search"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
</form>
                            </div>
                            <div class="hide-search">
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!---->
            <div class="header-container">
                <a href="../../index.html" class="brand-logo">
                    <span class="logo">
                        <img src="../../_static/images/Logo_Epam_Color.svg" alt=""/>
                    </span>
                    <span class="title">
                      Life Sciences Open Source
                    </span>
                </a>
                <ul class="uui-navigation nav navbar-nav">
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown">Products</a>
                        

<div class="dropdown-menu" role="menu">
    <div class="container"><h2>Cheminformatics</h2><hr><div class="dropdown-menu-row"><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../bingo/index.html">Bingo &raquo;</a></span><ul><li><a class="reference internal" href="../../bingo/bingo-oracle.html">Bingo Oracle</a></li><li><a class="reference internal" href="../../bingo/bingo-postgres.html">Bingo PostgreSQL</a></li><li><a class="reference internal" href="../../bingo/bingo-sqlserver.html">Bingo SQL Server</a></li><li><a class="reference internal" href="../../bingo/bingo-nosql.html">Bingo NoSQL</a></li><li><a class="reference internal" href="../../download/bingo.html">Downloads</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../index.html">Indigo Toolkit &raquo;</a></span><ul><li><a class="reference internal" href="#">API</a></li><li><a class="reference internal" href="reference.html">API Reference</a></li><li><a class="reference internal" href="../concepts/index.html">Concepts</a></li><li><a class="reference internal" href="../utilities.html">Indigo Utilities</a></li><li><a class="reference internal" href="../../download/indigo/index.html">Downloads</a></li><li><a class="reference internal" href="../build.html">Build</a></li><li><a class="reference internal" href="../installation.html">SDK Installation</a></li><li><a class="reference internal" href="../options/index.html">Options</a></li><li><a class="reference internal" href="../release-notes/index.html">Release Notes</a></li><li><a class="reference internal" href="../examples/index.html">Examples</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../ketcher/index.html">Ketcher &raquo;</a></span><ul><li><a class="reference internal" href="../../ketcher/editing-tips.html">Editing Tips</a></li><li><a class="reference internal" href="../../ketcher/developers-manual.html">Developers Manual</a></li><li><a class="reference internal" href="../../ketcher/help.html">Help</a></li><li><a class="reference internal" href="../../ketcher/demo.html">Ketcher 2.0 Demo</a></li><li><a class="reference internal" href="../../download/ketcher.html">Downloads</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../eln/index.html">Indigo ELN &raquo;</a></span><ul><li><a class="reference internal" href="../eln/changelog.html">Release Notes</a></li><li><a class="reference internal" href="../../download/indigo/eln.html">Downloads</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../imago/index.html">Imago OCR &raquo;</a></span><ul><li><a class="reference internal" href="../../imago/examples.html">Features and Examples</a></li><li><a class="reference internal" href="../../imago/report.html">Comparison Report</a></li><li><a class="reference internal" href="../../imago/imago-gui.html">Imago OCR Visual Tool</a></li><li><a class="reference internal" href="../../imago/imago_console.html">Imago Console Application</a></li><li><a class="reference internal" href="../../imago/c.html">C Library Reference</a></li><li><a class="reference internal" href="../../imago/java.html">Java Bindings</a></li><li><a class="reference internal" href="../../imago/dependencies.html">Dependencies</a></li><li><a class="reference internal" href="../../imago/changelog.html">Changelog</a></li><li><a class="reference internal" href="../../download/imago.html">Downloads</a></li></ul></div></div><h2>Bioinformatics</h2><hr><div class="dropdown-menu-row"><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../mri/index.html">Web3D DICOM Viewer &raquo;</a></span><ul><li><a class="reference internal" href="../../mri/papers.html">Research and Development</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../miew/index.html">Miew &raquo;</a></span><ul><li><a class="reference internal" href="../../miew/embed.html">Embedding the Viewer</a></li><li><a class="reference internal" href="../../miew/selectors.html">Selection Language</a></li></ul></div><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../ngb/index.html">NGB &raquo;</a></span></div></div><h2>Data processing</h2><hr><div class="dropdown-menu-row"><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../parso.html">Parso &raquo;</a></span><ul><li><a class="reference internal" href="../../parso/changelog.html">Release Notes</a></li><li><a class="reference internal" href="../../download/parso.html">Downloads</a></li></ul></div></div><h2>Software development</h2><hr><div class="dropdown-menu-row"><div class="dropdown-menu-column"><span class="nav-subtitle"><a class="reference internal" href="../../selenium.html">Selenium Framework &raquo;</a></span></div></div></div>
</div>
                    </li>
                    <li><a href="../../resources.html"><span>Resources</span></a></li>
                    <li><a href="../../download/index.html"><span>Downloads</span></a></li>
                    <li><a href="../../contact.html"><span>Contact Info</span></a></li>
                </ul>
                <ul class="uui-header-tools nav navbar-nav">
                    <li class="uui-global-search">
                        <div class="search-field">
                            <label></label>
                            <form action="../../search.html" method="get">
    <input type="search" name="q" class="uui-search" placeholder="Search"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
</form>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
    
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20662471-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</header>

        <div class="uui-main-container">
            <main>
                
                <section class="uui-breadcrumbs-container">
                    <div class="container">
                        <div class="row">
                            <ol class="uui-breadcrumbs">
                                <li><a href="../../index.html">Home</a></li>
                                
                                <li><a href="../index.html">Indigo Toolkit</a></li>
                                
                                <li class="active"><a href="#">API</a></li>
                            </ol>
                        </div>
                    </div>
                </section>
                <section class="promo-section">
                    <div class="container">
                        <div class="row">
                            
                                
                                <div class="col-xs-12 col-md-3" role="complementary">
                                    <div class="sidenav hidden-print hidden-xs hidden-sm affix-top" data-spy="affix" data-offset-top="0"
     data-offset-bottom="0">
    <section class="uui-accordion" id="accordion1">

        <!-- Filled in static/js/custom-sidenav.js -->
        <div id="local-toc" style="display: none;"><ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#basics">Basics</a><ul>
<li><a class="reference internal" href="#system">System</a></li>
<li><a class="reference internal" href="#indigo-constructor">Indigo Constructor</a></li>
<li><a class="reference internal" href="#getting-the-version-string">Getting the Version String</a></li>
</ul>
</li>
<li><a class="reference internal" href="#molecules">Molecules</a><ul>
<li><a class="reference internal" href="#loading-molecules-and-query-molecules">Loading Molecules and Query Molecules</a></li>
<li><a class="reference internal" href="#instrumenting-molecules">Instrumenting Molecules</a></li>
<li><a class="reference internal" href="#instrumenting-query-atoms">Instrumenting Query Atoms</a></li>
<li><a class="reference internal" href="#merging-molecules">Merging Molecules</a></li>
<li><a class="reference internal" href="#removing-atoms-and-bonds-from-molecules">Removing Atoms and Bonds from Molecules</a></li>
<li><a class="reference internal" href="#submolecules">Submolecules</a></li>
<li><a class="reference internal" href="#accessing-atoms-and-bonds">Accessing Atoms and Bonds</a></li>
<li><a class="reference internal" href="#getting-the-properties-of-atoms-and-bonds">Getting the Properties of Atoms and Bonds</a></li>
<li><a class="reference internal" href="#modifying-atoms-and-bonds">Modifying Atoms and Bonds</a></li>
<li><a class="reference internal" href="#accessing-neighbor-atoms">Accessing Neighbor Atoms</a></li>
<li><a class="reference internal" href="#accessing-r-groups">Accessing R-Groups</a></li>
<li><a class="reference internal" href="#expand-abbreviations">Expand abbreviations</a></li>
<li><a class="reference internal" href="#saving-molecules">Saving Molecules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reactions">Reactions</a><ul>
<li><a class="reference internal" href="#loading-reactions-and-query-reactions">Loading Reactions and Query Reactions</a></li>
<li><a class="reference internal" href="#instrumenting-reactions">Instrumenting Reactions</a></li>
<li><a class="reference internal" href="#accessing-reactions">Accessing Reactions</a></li>
<li><a class="reference internal" href="#saving-reactions">Saving Reactions</a></li>
<li><a class="reference internal" href="#reacting-centers">Reacting Centers</a></li>
<li><a class="reference internal" href="#reaction-atom-to-atom-mapping">Reaction Atom-to-Atom Mapping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calculating-properties">Calculating Properties</a><ul>
<li><a class="reference internal" href="#molecule-validation">Molecule Validation</a></li>
<li><a class="reference internal" href="#working-with-connected-components">Working with Connected Components</a></li>
<li><a class="reference internal" href="#canonical-smiles">Canonical SMILES</a></li>
<li><a class="reference internal" href="#attachment-points">Attachment points</a></li>
<li><a class="reference internal" href="#layout-2d-coordinates">Layout (2D coordinates)</a></li>
<li><a class="reference internal" href="#aromaticity">Aromaticity</a></li>
<li><a class="reference internal" href="#implicit-and-explicit-hydrogens">Implicit and Explicit Hydrogens</a></li>
<li><a class="reference internal" href="#stereochemistry">Stereochemistry</a></li>
<li><a class="reference internal" href="#enumeration-of-submolecules">Enumeration of Submolecules</a></li>
<li><a class="reference internal" href="#enumeration-of-tautomers">Enumeration of Tautomers</a></li>
<li><a class="reference internal" href="#sgroups">SGroups</a></li>
<li><a class="reference internal" href="#tgroups">TGroups</a></li>
<li><a class="reference internal" href="#alignment-of-atoms">Alignment of Atoms</a></li>
<li><a class="reference internal" href="#inchi">InChI</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#standardize-of-molecule">Standardize of Molecule</a></li>
<li><a class="reference internal" href="#ionize-of-molecule">Ionize of Molecule</a></li>
<li><a class="reference internal" href="#pka">pKa</a></li>
<li><a class="reference internal" href="#cip-stereo-descriptors">CIP Stereo Descriptors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#io">IO</a><ul>
<li><a class="reference internal" href="#reading-sdf-rdf-cml-multiline-smiles-files-cdx-binary">Reading SDF, RDF, CML, multiline SMILES files, CDX (binary)</a></li>
<li><a class="reference internal" href="#indexed-access">Indexed access</a></li>
<li><a class="reference internal" href="#accessing-molecule-and-reaction-properties">Accessing Molecule and Reaction Properties</a><ul>
<li><a class="reference internal" href="#names">Names</a></li>
<li><a class="reference internal" href="#sdf-rdf-cdx-properties">SDF/RDF/CDX Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-sdf-files">Writing SDF Files</a></li>
<li><a class="reference internal" href="#writing-rdf-files">Writing RDF Files</a></li>
<li><a class="reference internal" href="#writing-cml-files">Writing CML Files</a></li>
<li><a class="reference internal" href="#writing-multiline-smiles-files">Writing Multiline SMILES Files</a></li>
<li><a class="reference internal" href="#closing-files">Closing Files</a></li>
<li><a class="reference internal" href="#generic-interface-to-writing-files">Generic Interface to Writing Files</a></li>
<li><a class="reference internal" href="#writing-into-a-memory-buffer">Writing into a Memory Buffer</a></li>
<li><a class="reference internal" href="#serialization">Serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#match-and-similarity">Match and Similarity</a><ul>
<li><a class="reference internal" href="#fingerprints">Fingerprints</a></li>
<li><a class="reference internal" href="#molecule-and-reaction-similarity">Molecule and Reaction Similarity</a></li>
<li><a class="reference internal" href="#exact-match">Exact Match</a><ul>
<li><a class="reference internal" href="#exact-matching-flags-for-molecules">Exact Matching Flags for Molecules</a></li>
<li><a class="reference internal" href="#exact-matching-flags-for-reactions">Exact Matching Flags for Reactions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#molecule-substructure-matching">Molecule Substructure Matching</a><ul>
<li><a class="reference internal" href="#molecule-substructure-matching-flags">Molecule Substructure Matching Flags</a></li>
<li><a class="reference internal" href="#methods-of-substructure-matcher">Methods of Substructure Matcher</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reaction-substructure-matching">Reaction Substructure Matching</a></li>
<li><a class="reference internal" href="#converting-the-substructure-query-to-the-aromatic-form">Converting the Substructure Query to the Aromatic Form</a></li>
<li><a class="reference internal" href="#optimizing-the-substructure-query">Optimizing the Substructure Query</a></li>
<li><a class="reference internal" href="#methods-of-mapping-object">Methods of “mapping” object</a><ul>
<li><a class="reference internal" href="#example-1-mapping-query-molecule-atoms">Example 1 (mapping query molecule atoms)</a></li>
<li><a class="reference internal" href="#example-2-getting-the-highlighted-target-molecule">Example 2 (getting the highlighted target molecule)</a></li>
<li><a class="reference internal" href="#example-3-exact-match-between-reactions">Example 3 (exact match between reactions)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tautomer-matching-rules">Tautomer Matching Rules</a><ul>
<li><a class="reference internal" href="#customizing-the-rules">Customizing the rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#highlighting-atoms-and-bonds">Highlighting Atoms and Bonds</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rendering">Rendering</a><ul>
<li><a class="reference internal" href="#rendering-multiple-items-to-grid">Rendering Multiple Items to Grid</a></li>
<li><a class="reference internal" href="#win32-and-net-support">Win32 and .NET Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scaffold-detection-and-r-group-decomposition">Scaffold Detection and R-Group Decomposition</a><ul>
<li><a class="reference internal" href="#scaffold-detection">Scaffold Detection</a></li>
<li><a class="reference internal" href="#r-group-decomposition">R-Group Decomposition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reaction-products-enumeration">Reaction Products Enumeration</a><ul>
<li><a class="reference internal" href="#reaction-based-molecule-transformations">Reaction-based Molecule Transformations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

    </section>
</div>
                                </div>
                                
                            
                            
                                <div class="col-xs-12 col-md-9" role="main">
                            
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This page describes the API of Indigo library and its rendering plugin.
The API allows developers to integrate Indigo into their
C/Java/C#/Python projects. Please note that Indigo is under active
development, and can always post your <a class="reference external" href="../../contact.html#feedback-on-open-source-software">comments and
suggestions</a> to
our team.</p>
</div>
<div class="section" id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="system">
<h3>System<a class="headerlink" href="#system" title="Permalink to this headline">¶</a></h3>
<p>Indigo acts like a state machine that consists of:</p>
<ul class="simple">
<li>Objects</li>
<li>Configuration settings</li>
<li>Error handling facility</li>
</ul>
<p>It is possible to use more than one Indigo instance at a time. In plain
C API, the “active” instance can be switched with <code class="docutils literal"><span class="pre">indigoSetSession</span></code>
call, while in Python, Java, and C#, the instance is represented as an
object of class <code class="docutils literal"><span class="pre">Indigo</span></code>.</p>
<p>The objects that belong to the Indigo state machine are represented as
integer handles in the C API, while in Python, Java, and C# they are
wrapped by the <code class="docutils literal"><span class="pre">IndigoObject</span></code> class.</p>
<p>Access to configuration settings is done via <code class="docutils literal"><span class="pre">indigoSetOption***</span></code>
functions in the C API, while in Python, Java, and C# a number of
<code class="docutils literal"><span class="pre">Indigo.setOption</span></code> methods can accomplish it.</p>
<p>Error handling in C is done via return codes, <code class="docutils literal"><span class="pre">indigoGetLastError</span></code>,
and <code class="docutils literal"><span class="pre">indigoSetErrorHandler</span></code>. In Python, Java, and C#, as soon as some
Indigo function terminates with an error, an <code class="docutils literal"><span class="pre">IndigoException</span></code> is
thrown.</p>
<p>Several library instances may be created to act simultaneously and
independently. However, each instance requires a certain amount of
memory, and thus it is recommended to have as few instances as possible.</p>
<p>It is allowable to have multiple Indigo instances within one program and
even in different threads. However, using a single Indigo instance
across multiple threads is prohibited.</p>
<p>From now on, only the Python, Java, and C# interfaces are explained. For
those who are interested in plain C interface, please read the <a class="reference external" href="reference.html#plain-c">C
API</a> page.</p>
</div>
<div class="section" id="indigo-constructor">
<h3>Indigo Constructor<a class="headerlink" href="#indigo-constructor" title="Permalink to this headline">¶</a></h3>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.epam.indigo.*</span><span class="o">;</span>
<span class="o">...</span>
<span class="n">Indigo</span> <span class="n">indigo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Indigo</span><span class="o">();</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">com.epam.indigo</span><span class="p">;</span>
<span class="p">....</span>
<span class="n">Indigo</span> <span class="n">indigo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Indigo</span><span class="p">();</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">indigo</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">...</span>
<span class="n">indigo</span> <span class="o">=</span> <span class="n">Indigo</span><span class="p">()</span>
</pre></div>
</div>
<p>Python will assume the Indigo binaries stored in the <code class="docutils literal"><span class="pre">lib</span></code> directory
in the directory where <code class="docutils literal"><span class="pre">indigo.py</span></code> is located. In C# and Java, the
binaries are unpacked automatically into the system temporary folder.</p>
</div>
<div class="section" id="getting-the-version-string">
<h3>Getting the Version String<a class="headerlink" href="#getting-the-version-string" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal"><span class="pre">Indigo.version</span></code> method to get the string containing
the Indigo library version number.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Indigo version &quot;</span> <span class="o">+</span> <span class="n">indigo</span><span class="o">.</span><span class="na">version</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Indigo version &quot;</span> <span class="p">+</span> <span class="n">indigo</span><span class="p">.</span><span class="n">version</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="s2">&quot;Indigo version &quot;</span> <span class="o">+</span> <span class="n">indigo</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="molecules">
<h2>Molecules<a class="headerlink" href="#molecules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-molecules-and-query-molecules">
<h3>Loading Molecules and Query Molecules<a class="headerlink" href="#loading-molecules-and-query-molecules" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo</span></code> object provides methods for loading <a class="reference external" href="../concepts/index.html#molecules-and-query-molecules">molecules and query
molecules</a>
from: strings, <code class="docutils literal"><span class="pre">byte[]</span></code> buffers, and files. The input format is
detected automatically, except for SMARTS expressions, for which there
are special methods.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;ONc1cccc1&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">mol2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMoleculeFromFile</span><span class="p">(</span><span class="s">&quot;structure.mol&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qmol1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadQueryMolecule</span><span class="p">(</span><span class="s">&quot;C1-C-C-C-1&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qmol2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadQueryMoleculeFromFile</span><span class="p">(</span><span class="s">&quot;query.mol&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qmol3</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s">&quot;[N,n,O;!H0]&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qmol4</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadSmartsFromFile</span><span class="p">(</span><span class="s">&quot;query.sma&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="instrumenting-molecules">
<h3>Instrumenting Molecules<a class="headerlink" href="#instrumenting-molecules" title="Permalink to this headline">¶</a></h3>
<p>You can programmatically add atoms and bonds to a molecule. Atoms can be
added with the <code class="docutils literal"><span class="pre">addAtom</span></code> method of the molecule. This method accepts
an atom symbol (a string) — an element from the periodic table, or a
pseudoatom. Similarly, bonds can be added by calling <code class="docutils literal"><span class="pre">addBond</span></code> method
of an atom. This method accepts another atom and the order of the new
bond. You can also create an empty molecule by calling the
<code class="docutils literal"><span class="pre">createMolecule</span></code> method.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createMolecule</span><span class="p">();</span>
<span class="n">IndigoObject</span> <span class="n">atom1</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">atom2</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">atom3</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">atom4</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">atom5</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">atom6</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;N&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond1</span> <span class="p">=</span> <span class="n">atom1</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom2</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond2</span> <span class="p">=</span> <span class="n">atom2</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom3</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond3</span> <span class="p">=</span> <span class="n">atom3</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom4</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond4</span> <span class="p">=</span> <span class="n">atom4</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom5</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond5</span> <span class="p">=</span> <span class="n">atom5</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom6</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">bond6</span> <span class="p">=</span> <span class="n">atom6</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">atom1</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
</pre></div>
</div>
<p>You can programmatically construct a query molecule via
<code class="docutils literal"><span class="pre">createQueryMolecule</span></code> method.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">qmol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createQueryMolecule</span><span class="p">()</span>
<span class="n">IndigoObject</span> <span class="n">a1</span> <span class="p">=</span> <span class="n">qmol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">)</span>
<span class="n">IndigoObject</span> <span class="n">a2</span> <span class="p">=</span> <span class="n">qmol</span><span class="p">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s">&quot;[#6]&quot;</span><span class="p">)</span>
<span class="n">a2</span><span class="p">.</span><span class="n">addBond</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
<p>You can reset existing atom keeping its connections and stereo
configuration using <code class="docutils literal"><span class="pre">IndigoObject.resetAtom</span></code> method. It accepts string
representation of an atom in the SMILES (or SMARTS for the queries)
notation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">resetAtom</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To add R-sites or convert existing atom into R-site you can use
<code class="docutils literal"><span class="pre">addRSite</span></code> and <code class="docutils literal"><span class="pre">setRSite</span></code> methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">addRSite</span><span class="p">(</span><span class="s2">&quot;R3&quot;</span><span class="p">)</span>
<span class="n">atom2</span><span class="o">.</span><span class="n">setRSite</span><span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instrumenting-query-atoms">
<h3>Instrumenting Query Atoms<a class="headerlink" href="#instrumenting-query-atoms" title="Permalink to this headline">¶</a></h3>
<p>Each atom and bond in the query molecule represents as a logic
expression of various properties. Indigo support almost all constraints
from the SMARTS specification. To alter existing constraints you can use
the following methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">addConstraint(type,</span> <span class="pre">value)</span></code> — adds a specified constraint using
logical <code class="docutils literal"><span class="pre">and</span></code> operation.</li>
<li><code class="docutils literal"><span class="pre">addConstraintNot(type,</span> <span class="pre">value)</span></code> — adds a negation of a constraint</li>
<li><code class="docutils literal"><span class="pre">addConstraintOr(type,</span> <span class="pre">value)</span></code> — adds a constraint using logical
<code class="docutils literal"><span class="pre">or</span></code> operation.</li>
<li><code class="docutils literal"><span class="pre">removeConstraints(type)</span></code> — removed all constraints with a
specified type.</li>
</ul>
<p>The following self-explaining integer constraint types are supported:</p>
<ul class="simple">
<li>“atomic-number”</li>
<li>“charge”</li>
<li>“isotope”</li>
<li>“radical”</li>
<li>“valence”</li>
<li>“connectivity”</li>
<li>“total-bond-order”</li>
<li>“hydrogens”</li>
<li>“substituents”</li>
<li>“ring”</li>
<li>“smallest-ring-size”</li>
<li>“ring-bonds”</li>
<li>“rsite-mask”</li>
<li>“rsite”</li>
</ul>
<p>Other constraints:</p>
<ul class="simple">
<li>“aromaticity” = “aliphatic” or “aromatic”</li>
<li>“smarts” — any single-atom SMARTS expression</li>
</ul>
<p>Code example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createQueryMolecule</span><span class="p">()</span>
<span class="n">atom</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">atom</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;substituents&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">)</span>
<span class="n">atom</span><span class="o">.</span><span class="n">addConstraintNot</span><span class="p">(</span><span class="s2">&quot;atomic-number&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">)</span>
<span class="n">atom</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;smarts&quot;</span><span class="p">,</span> <span class="s2">&quot;[$([#6]=[N+]=[N-]),$([#6-]-[N+]#[N])]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-molecules">
<h3>Merging Molecules<a class="headerlink" href="#merging-molecules" title="Permalink to this headline">¶</a></h3>
<p>You can merge one molecule into another using the <code class="docutils literal"><span class="pre">merge</span></code> method of a
molecule. This method accepts a molecule that is to be merged into the
first molecule, and returns a “mapping” object. You can call the
<code class="docutils literal"><span class="pre">mapAtom</span></code> method of the mapping object to know what is the (new) atom
of the first molecule that was transferred from the second molecule.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;c1ccccc1&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">mol2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;ON&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">mapping</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mol2</span><span class="p">);</span>
<span class="n">mapping</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">mol2</span><span class="p">.</span><span class="n">getAtom</span><span class="p">(</span><span class="m">0</span><span class="p">)).</span><span class="n">addBond</span><span class="p">(</span><span class="n">mol</span><span class="p">.</span><span class="n">getAtom</span><span class="p">(</span><span class="m">3</span><span class="p">),</span> <span class="m">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="removing-atoms-and-bonds-from-molecules">
<h3>Removing Atoms and Bonds from Molecules<a class="headerlink" href="#removing-atoms-and-bonds-from-molecules" title="Permalink to this headline">¶</a></h3>
<p>You can call the <code class="docutils literal"><span class="pre">IndigoObject.remove</span></code> method on an atom or a bond to
remove it from the molecule it belongs to. Also, if you want to remove
many atoms at once, you can call <code class="docutils literal"><span class="pre">IndigoObject.removeAtoms</span></code> method,
providing to it an array of indices of atoms that you want to remove.</p>
</div>
<div class="section" id="submolecules">
<h3>Submolecules<a class="headerlink" href="#submolecules" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.createSubmolecule</span></code> method is applicable to a
molecule or a query molecule. It accepts an array of atom indices and
returns a new molecule containing the given atoms copied from the
molecule, and the bonds between them.</p>
<p>Similarly, the <code class="docutils literal"><span class="pre">IndigoObject.createEdgeSubmolecule</span></code> method accepts two
arrays — atom indices and bond indices — and returns a new molecule
containing the given atoms and bonds copied from the molecule.</p>
<p>Indigo allows to create a reference on a submolecule of a molecule with
method <code class="docutils literal"><span class="pre">IndigoObject.getSubmolecule</span></code>. Such molecule can be later used
for finding layout of a molecule part.</p>
</div>
<div class="section" id="accessing-atoms-and-bonds">
<h3>Accessing Atoms and Bonds<a class="headerlink" href="#accessing-atoms-and-bonds" title="Permalink to this headline">¶</a></h3>
<p>The following methods can be applied to a molecule or query molecule:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">getAtom</span></code> — returns the atom by the given index.</li>
<li><code class="docutils literal"><span class="pre">getBond</span></code> — returns the bond by the given index.</li>
<li><code class="docutils literal"><span class="pre">iterateAtoms</span></code> — returns an iterator over atoms, including
pseudoatoms and R-sites.</li>
<li><code class="docutils literal"><span class="pre">iteratePseudoatoms</span></code> — returns an iterator over pseudoatoms.</li>
<li><code class="docutils literal"><span class="pre">iterateRSites</span></code> — returns an iterator over R-sites.</li>
<li><code class="docutils literal"><span class="pre">iterateBonds</span></code> — returns an iterator over bonds.</li>
</ul>
</div>
<div class="section" id="getting-the-properties-of-atoms-and-bonds">
<h3>Getting the Properties of Atoms and Bonds<a class="headerlink" href="#getting-the-properties-of-atoms-and-bonds" title="Permalink to this headline">¶</a></h3>
<p>The following methods of a molecule’s atom can be called to obtain
information:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">atomicNumber</span></code> — returns zero if the atomic number is undefined or
ambiguous. (happens only on queries). This method can not be applied
to R-sites or pseudoatoms.</li>
<li><code class="docutils literal"><span class="pre">isotope</span></code> — returns the isotope value or zero if the atomic number
is undefined or ambiguous.</li>
<li><code class="docutils literal"><span class="pre">degree</span></code> — returns explicit atom degree.</li>
<li><code class="docutils literal"><span class="pre">charge</span></code> — returns the charge value or <code class="docutils literal"><span class="pre">null</span></code> if the charge is
undefined (can happens only on queries).</li>
<li><code class="docutils literal"><span class="pre">explicitValence</span></code> — returns the explicit valence or <code class="docutils literal"><span class="pre">null</span></code> if
there is no explicit valence.</li>
<li><code class="docutils literal"><span class="pre">radicalElectrons</span></code> — returns the number of radical electrons or
<code class="docutils literal"><span class="pre">null</span></code> if the radical is undefined (can happen only on queries).</li>
<li><code class="docutils literal"><span class="pre">countHydrogens</span></code> — returns the total number of hydrogens connected
to the atom (explicit+implicit). Can return <code class="docutils literal"><span class="pre">null</span></code> on query atoms
where the number of hydrogens is not definitely known.</li>
<li><code class="docutils literal"><span class="pre">countImplicitHydrogens</span></code> — returns the number of implicit hydrogens
connected to the atom. Not applicable to query atoms.</li>
<li><code class="docutils literal"><span class="pre">valence</span></code> — returns the valence of the atom. Not applicable to
query atoms.</li>
<li><code class="docutils literal"><span class="pre">isPseudoatom</span></code> — returns <code class="docutils literal"><span class="pre">true</span></code> if the atom is a pseudoatom,
<code class="docutils literal"><span class="pre">false</span></code> otherwise.</li>
<li><code class="docutils literal"><span class="pre">isRSite</span></code> — returns <code class="docutils literal"><span class="pre">true</span></code> if the atom is a pseudoatom, <code class="docutils literal"><span class="pre">false</span></code>
otherwise.</li>
<li><code class="docutils literal"><span class="pre">symbol</span></code> — returns a string containing the atom symbol. It is
either a symbol the periodic table (“C”, “Na”), or a pseudoatom label
(“Res”), or an R-site mark (“R1”).</li>
<li><code class="docutils literal"><span class="pre">xyz</span></code> —returns an array of three <code class="docutils literal"><span class="pre">float</span></code> numbers, which define the
position of the atom.</li>
<li><code class="docutils literal"><span class="pre">singleAllowedRGroup</span></code> — R-Group index allowed on R-Site (usually
there is a single allowed index). This method can be applied
exclusively to R-sites.</li>
</ul>
<p>The following <code class="docutils literal"><span class="pre">IndigoObject</span></code> methods can be applied to molecule’s
bonds:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bondOrder</span></code> — returns 1/2/3 if the bond is a single/double/triple
bond. Returns 4 if the bond is an aromatic bond. Returns zero if the
bond is ambiguous (query bond).</li>
<li><code class="docutils literal"><span class="pre">source</span></code> — the atom from which the bond is going</li>
<li><code class="docutils literal"><span class="pre">destination</span></code> — the atom to which the bond is going</li>
<li><code class="docutils literal"><span class="pre">topology</span></code> — returns Indigo.RING or Indigo.CHAIN, depending on
whether the bond is a ring bond or not. Returns zero if the bond is
ambiguous (query bond).</li>
</ul>
</div>
<div class="section" id="modifying-atoms-and-bonds">
<h3>Modifying Atoms and Bonds<a class="headerlink" href="#modifying-atoms-and-bonds" title="Permalink to this headline">¶</a></h3>
<p>The following methods of a molecule’s atom can be called to modify the
atom:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">resetCharge</span></code></li>
<li><code class="docutils literal"><span class="pre">resetExplicitValence</span></code></li>
<li><code class="docutils literal"><span class="pre">resetIsotope</span></code></li>
<li><code class="docutils literal"><span class="pre">resetRadical</span></code></li>
<li><code class="docutils literal"><span class="pre">setCharge</span></code> — accepts an integer charge value</li>
<li><code class="docutils literal"><span class="pre">setIsotope</span></code> — accepts an integer isotope value</li>
<li><code class="docutils literal"><span class="pre">setXYZ</span></code> — accepts three float numbers (X, Y, Z)</li>
<li><code class="docutils literal"><span class="pre">setAttachmentPoint</span></code> — accepts an integer index of the attachment
point (usually 1 or 2).</li>
<li><code class="docutils literal"><span class="pre">setBondOrder</span></code> — accepts an integer value (1/2/3/4 for
single/double/triple/aromatic)</li>
</ul>
</div>
<div class="section" id="accessing-neighbor-atoms">
<h3>Accessing Neighbor Atoms<a class="headerlink" href="#accessing-neighbor-atoms" title="Permalink to this headline">¶</a></h3>
<p>With <code class="docutils literal"><span class="pre">iterateNeighbors</span></code> method you can access the neighbors atoms of
an atom. Also, these “neighbor” objects respond to the <code class="docutils literal"><span class="pre">bond</span></code> method,
which returns the bond connecting the atom with the neighbor.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
<span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;atom %d: %d neighbors\n&quot;</span><span class="o">,</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">atom</span><span class="o">.</span><span class="na">degree</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">nei</span> <span class="o">:</span> <span class="n">atom</span><span class="o">.</span><span class="na">iterateNeighbors</span><span class="o">())</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;neighbor atom %d is connected by bond %d\n&quot;</span><span class="o">,</span> <span class="n">nei</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">nei</span><span class="o">.</span><span class="na">bond</span><span class="o">().</span><span class="na">index</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">C#:</div>
</div>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;atom {0}: {1} neighbors\n&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">atom</span><span class="p">.</span><span class="n">degree</span><span class="p">());</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">nei</span> <span class="k">in</span> <span class="n">atom</span><span class="p">.</span><span class="n">iterateNeighbors</span><span class="p">())</span>
    <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;neighbor atom {0} is connected by bond {1}\n&quot;</span><span class="p">,</span> <span class="n">nei</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">nei</span><span class="p">.</span><span class="n">bond</span><span class="p">().</span><span class="n">index</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
  <span class="k">print</span> <span class="s2">&quot;atom </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2"> neighbors&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">atom</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span>
  <span class="k">for</span> <span class="n">nei</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">iterateNeighbors</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;neighbor atom </span><span class="si">%d</span><span class="s2"> is connected by bond </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nei</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">nei</span><span class="o">.</span><span class="n">bond</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-r-groups">
<h3>Accessing R-Groups<a class="headerlink" href="#accessing-r-groups" title="Permalink to this headline">¶</a></h3>
<p><strong>Note</strong>: This section applies exclusively to query molecules.</p>
<p>The <code class="docutils literal"><span class="pre">iterateRGroups</span></code> method iterates over a query molecule’s R-groups.
Each of the R-groups has a collection of possible “R-group fragments”,
which in turn can be accessed via the <code class="docutils literal"><span class="pre">iterateRGroupFragments</span></code> method.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">rg</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateRGroups</span><span class="o">())</span>
<span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;RGROUP #&quot;</span> <span class="o">+</span> <span class="n">rg</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">frag</span> <span class="o">:</span> <span class="n">rg</span><span class="o">.</span><span class="na">iterateRGroupFragments</span><span class="o">())</span>
  <span class="o">{</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;  FRAGMENT #&quot;</span> <span class="o">+</span> <span class="n">rg</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">frag</span><span class="o">.</span><span class="na">molfile</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">rg</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateRGroups</span><span class="p">())</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;RGROUP #&quot;</span> <span class="p">+</span> <span class="n">rg</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">frag</span> <span class="k">in</span> <span class="n">rg</span><span class="p">.</span><span class="n">iterateRGroupFragments</span><span class="p">())</span>
  <span class="p">{</span>
     <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;  FRAGMENT #&quot;</span> <span class="p">+</span> <span class="n">rg</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
     <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">frag</span><span class="p">.</span><span class="n">molfile</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">rg</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateRGroups</span><span class="p">():</span>
  <span class="k">print</span> <span class="s2">&quot;RGROUP #&quot;</span> <span class="o">+</span> <span class="n">rg</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">rg</span><span class="o">.</span><span class="n">iterateRGroupFragments</span><span class="p">():</span>
     <span class="k">print</span> <span class="s2">&quot;  FRAGMENT #&quot;</span> <span class="o">+</span> <span class="n">rg</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
     <span class="k">print</span> <span class="n">frag</span><span class="o">.</span><span class="n">molfile</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="expand-abbreviations">
<h3>Expand abbreviations<a class="headerlink" href="#expand-abbreviations" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">expandAbbreviations</span></code> function converts input structure using the abbreviations <strong>dictionary</strong> into the expanded form. By default, Indigo uses the following structures list:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Expansion</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CO2</td>
<td>[*:2]OC([*:1])=O</td>
</tr>
<tr class="row-odd"><td>Ph</td>
<td>*C1=CC=CC=C1</td>
</tr>
<tr class="row-even"><td>CO</td>
<td>[*:1]C([*:2])=O</td>
</tr>
<tr class="row-odd"><td>SO2</td>
<td>[*:1]S(=O)(=O)[*:2]</td>
</tr>
<tr class="row-even"><td>Me</td>
<td>*C</td>
</tr>
<tr class="row-odd"><td>Et</td>
<td>*CC</td>
</tr>
<tr class="row-even"><td>Boc</td>
<td>CC(C)(C)OC([*])=O</td>
</tr>
<tr class="row-odd"><td>Bz</td>
<td>[*]C(=O)C1=CC=CC=C1</td>
</tr>
<tr class="row-even"><td>Cbz</td>
<td>[*]C(=O)OCC1=CC=CC=C1</td>
</tr>
<tr class="row-odd"><td>Ac</td>
<td>CC(=O)[*]</td>
</tr>
<tr class="row-even"><td>NO2</td>
<td>[O-][N+]([*])=O</td>
</tr>
<tr class="row-odd"><td>NO</td>
<td>*N=O</td>
</tr>
<tr class="row-even"><td>CN</td>
<td>[*]C#N</td>
</tr>
<tr class="row-odd"><td>CHO</td>
<td>[*]C=O</td>
</tr>
<tr class="row-even"><td>N3</td>
<td>[*]N=[N+]=[N-]</td>
</tr>
<tr class="row-odd"><td>C2H5O</td>
<td>[*]OCC</td>
</tr>
<tr class="row-even"><td>C6H11</td>
<td>[*]C1CCCCC1</td>
</tr>
<tr class="row-odd"><td>PMB</td>
<td>COC1=CC=C(C[*])C=C1</td>
</tr>
<tr class="row-even"><td>Bn</td>
<td>[*]CC1=CC=CC=C1</td>
</tr>
<tr class="row-odd"><td>Ms</td>
<td>CS([*])(=O)=O</td>
</tr>
<tr class="row-even"><td>Cys</td>
<td>SC[C&#64;H](N[*:1])C([*:2])=O</td>
</tr>
<tr class="row-odd"><td>Pr</td>
<td>*CCC</td>
</tr>
<tr class="row-even"><td>Ts</td>
<td>CC1=CC=C(C=C1)S([*])(=O)=O</td>
</tr>
<tr class="row-odd"><td>t-Bu</td>
<td>CC(C)(C)[*]</td>
</tr>
<tr class="row-even"><td>Bu</td>
<td>CCCC[*]</td>
</tr>
<tr class="row-odd"><td>Tf</td>
<td>FC(F)(F)S([*])(=O)=O</td>
</tr>
<tr class="row-even"><td>Tos</td>
<td>CC1=CC=C(C=C1)S([*])(=O)=O</td>
</tr>
<tr class="row-odd"><td>FMOC</td>
<td>[*]C(=O)OCC1C2=CC=CC=C2C2=C1C=CC=C2</td>
</tr>
<tr class="row-even"><td>SO3-</td>
<td>[O-]S([*])(=O)=O</td>
</tr>
<tr class="row-odd"><td>SO3H</td>
<td>[OH]S([*])(=O)=O</td>
</tr>
<tr class="row-even"><td>O-</td>
<td>*[O-]</td>
</tr>
<tr class="row-odd"><td>NH3+</td>
<td>*[NH3+]</td>
</tr>
<tr class="row-even"><td>SiPr</td>
<td>CC(C)S[*]</td>
</tr>
<tr class="row-odd"><td>iPr</td>
<td>CC(C)[*]</td>
</tr>
<tr class="row-even"><td>CHOH</td>
<td>OC([*:1])[*:2]</td>
</tr>
</tbody>
</table>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;molfile_with_alias.mol&quot;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">expandAbbreviations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-molecules">
<h3>Saving Molecules<a class="headerlink" href="#saving-molecules" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">IndigoObject.smiles</span></code>, when applied to a molecule, returns a SMILES
string. Similarly, <code class="docutils literal"><span class="pre">IndigoObject.molfile</span></code> returns a string with a
Molfile, while <code class="docutils literal"><span class="pre">IndigoObject.cml</span></code> returns a string with CML
representation. <code class="docutils literal"><span class="pre">IndigoObject.saveMolfile</span></code> and
<code class="docutils literal"><span class="pre">IndigoObject.saveCml</span></code> methods save Molfile and CML to disk.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mol1</span><span class="o">.</span><span class="na">molfile</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mol2</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
<span class="n">qmol1</span><span class="o">.</span><span class="na">saveMolfile</span><span class="o">(</span><span class="s">&quot;query.mol&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">mol1</span><span class="p">.</span><span class="n">molfile</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">mol2</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
<span class="n">qmol1</span><span class="p">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;query.mol&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">mol1</span><span class="o">.</span><span class="n">molfile</span><span class="p">()</span>
<span class="k">print</span> <span class="n">mol2</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
<span class="n">qmol1</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;query.mol&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reactions">
<h2>Reactions<a class="headerlink" href="#reactions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-reactions-and-query-reactions">
<h3>Loading Reactions and Query Reactions<a class="headerlink" href="#loading-reactions-and-query-reactions" title="Permalink to this headline">¶</a></h3>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">rxn1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReaction</span><span class="p">(</span><span class="s">&quot;[I-].[Na+].C=CCBr&gt;&gt;[Na+].[Br-].C=CCI&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">rxn2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReactionFromFile</span><span class="p">(</span><span class="s">&quot;reaction.rxn&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qrxn1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadQueryReaction</span><span class="p">(</span><span class="s">&quot;CBr&gt;&gt;CCl&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">qrxn2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadQueryReactionFromFile</span><span class="p">(</span><span class="s">&quot;query.rxn&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">rs</span>    <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReactionSmarts</span><span class="p">(</span><span class="s">&quot;[C$(CO)]&gt;&gt;[C$(CN)]&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">rs2</span>   <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReactionSmartsFromFile</span><span class="p">(</span><span class="s">&quot;query.sma&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="instrumenting-reactions">
<h3>Instrumenting Reactions<a class="headerlink" href="#instrumenting-reactions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo.createReaction</span></code> method returns an empty reaction. The
<code class="docutils literal"><span class="pre">Indigo.createQueryReaction</span></code> method returns an empty query reaction.
The <code class="docutils literal"><span class="pre">IndigoObject.addReactant</span></code>, <code class="docutils literal"><span class="pre">IndigoObject.addProduct</span></code>, and
<code class="docutils literal"><span class="pre">IndigoObject.addCatalyst</span></code> methods can then be used to fill it up.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">rxn</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createReaction</span><span class="p">();</span>
<span class="n">rxn</span><span class="p">.</span><span class="n">addReactant</span><span class="p">(</span><span class="n">mol1</span><span class="p">);</span>
<span class="n">rxn</span><span class="p">.</span><span class="n">addReactant</span><span class="p">(</span><span class="n">mol2</span><span class="p">);</span>
<span class="n">rxn</span><span class="p">.</span><span class="n">addProduct</span><span class="p">(</span><span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;ClC1CCCCC1));</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="accessing-reactions">
<h3>Accessing Reactions<a class="headerlink" href="#accessing-reactions" title="Permalink to this headline">¶</a></h3>
<p>Reactions respond to the following <code class="docutils literal"><span class="pre">IndigoObject</span></code> methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IndigoObject.iterateReactants</span></code> — enumerates reactants</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.iterateProducts</span></code> — enumerates products</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.iterateCatalysts</span></code> — enumerates catalysts</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.iterateMolecules</span></code> — enumerates reactants, products,
and catalysts, in no particular order</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countReactants</span></code> — returns the number of reactants</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countProducts</span></code> — returns the number of products</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countCatalysts</span></code> — returns the number of catalysts</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countMolecules</span></code> — returns the total number of
molecules in the reaction</li>
</ul>
<p>You can also call the <code class="docutils literal"><span class="pre">IndigoObject.remove</span></code> method of the reaction
molecule to remove it from the reaction.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rxn</span><span class="o">.</span><span class="na">countMolecules</span><span class="o">());</span>
<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">rxn</span><span class="o">.</span><span class="na">iterateReactants</span><span class="o">())</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">molfile</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">rxn</span><span class="o">.</span><span class="na">iterateCatalysts</span><span class="o">())</span>
   <span class="n">item</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">rxn</span><span class="p">.</span><span class="n">countMolecules</span><span class="p">());</span>
<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">rxn</span><span class="p">.</span><span class="n">iterateReactants</span><span class="p">())</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">molfile</span><span class="p">());</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">rxn</span><span class="p">.</span><span class="n">iterateCatalysts</span><span class="p">())</span>
   <span class="n">item</span><span class="p">.</span><span class="k">remove</span><span class="p">();</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">rxn</span><span class="o">.</span><span class="n">countMolecules</span><span class="p">()</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">iterateReactants</span><span class="p">():</span>
   <span class="k">print</span> <span class="n">item</span><span class="o">.</span><span class="n">molfile</span><span class="p">()</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">iterateCatalysts</span><span class="p">():</span>
   <span class="n">item</span><span class="o">.</span><span class="n">remove</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-reactions">
<h3>Saving Reactions<a class="headerlink" href="#saving-reactions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.smiles</span></code>, when applied to a reaction, returns a
reaction SMILES string. Similarly, the <code class="docutils literal"><span class="pre">IndigoObject.rxnfile</span></code> returns
a string with an Rxnfile. The <code class="docutils literal"><span class="pre">IndigoObject.saveRxnfile</span></code> method saves
the Rxnfile to disk.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rxn</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rxn</span><span class="o">.</span><span class="na">rxnfile</span><span class="o">());</span>
<span class="n">rxn</span><span class="o">.</span><span class="na">saveRxnfile</span><span class="o">(</span><span class="s">&quot;reaction.rxn&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">rxn</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">rxn</span><span class="p">.</span><span class="n">rxnfile</span><span class="p">());</span>
<span class="n">rxn</span><span class="p">.</span><span class="n">saveRxnfile</span><span class="p">(</span><span class="s">&quot;reaction.rxn&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">rxn</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
<span class="k">print</span> <span class="n">rxn</span><span class="o">.</span><span class="n">rxnfile</span><span class="p">()</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">saveRxnfile</span><span class="p">(</span><span class="s2">&quot;reaction.rxn&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reacting-centers">
<h3>Reacting Centers<a class="headerlink" href="#reacting-centers" title="Permalink to this headline">¶</a></h3>
<p>Reacting centers include bonds that are involved in the reaction. Indigo
supports the following types of reacting centers:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Indigo.RC_NOT_CENTER</span></code></li>
<li><code class="docutils literal"><span class="pre">Indigo.RC_UNMARKED</span></code></li>
<li><code class="docutils literal"><span class="pre">Indigo.RC_CENTER</span></code></li>
<li><code class="docutils literal"><span class="pre">Indigo.RC_UNCHANGED</span></code></li>
<li><code class="docutils literal"><span class="pre">Indigo.RC_MADE_OR_BROKEN</span></code></li>
<li><code class="docutils literal"><span class="pre">Indigo.RC_ORDER_CHANGED</span></code></li>
</ul>
<p>These values are bit flags, and can be combined.
<code class="docutils literal"><span class="pre">IndigoObject.reactingCenter</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.setReactingCenter</span></code>
are the getter and setter of the bond reacting center property.</p>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;reacting centers:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">iterateMolecules</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="n">rxn</span><span class="o">.</span><span class="n">reactingCenter</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">iterateMolecules</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">():</span>
        <span class="n">rxn</span><span class="o">.</span><span class="n">setReactingCenter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">Indigo</span><span class="o">.</span><span class="n">RC_CENTER</span> <span class="o">|</span> <span class="n">Indigo</span><span class="o">.</span><span class="n">RC_UNCHANGED</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.correctReactingCenters</span></code> method highlights bond
reacting centers according to AAM.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;discard&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">correctReactingCenters</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="reaction-atom-to-atom-mapping">
<h3>Reaction Atom-to-Atom Mapping<a class="headerlink" href="#reaction-atom-to-atom-mapping" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.automap(mode</span> <span class="pre">[ignore_option])</span></code> method is purposed
for generating reaction atom-to-atom mapping (AAM). The method accepts a
string parameter called <code class="docutils literal"><span class="pre">mode</span></code>. The following modes are available:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">discard</span></code> : discards the existing mapping entirely and considers
only the existing reaction centers (the default)</li>
<li><code class="docutils literal"><span class="pre">keep</span></code> : keeps the existing mapping and maps unmapped atoms</li>
<li><code class="docutils literal"><span class="pre">alter</span></code> : alters the existing mapping, and maps the rest of the
reaction but may change the existing mapping</li>
<li><code class="docutils literal"><span class="pre">clear</span></code> : removes the mapping from the reaction</li>
</ul>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;discard&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">saveRxnfile</span><span class="p">(</span><span class="s2">&quot;rxn_aam.rxn&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;clear&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">saveSmiles</span><span class="p">(</span><span class="s2">&quot;rxn_noaam.smi&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The following options can be added after the <code class="docutils literal"><span class="pre">discard</span></code>, <code class="docutils literal"><span class="pre">keep</span></code> or
<code class="docutils literal"><span class="pre">alter</span></code> modes (separated by a space):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ignore_charges</span></code> : do not consider atom charges while searching</li>
<li><code class="docutils literal"><span class="pre">ignore_isotopes</span></code> : do not consider atom isotopes while searching</li>
<li><code class="docutils literal"><span class="pre">ignore_valence</span></code> : do not consider atom valence while searching</li>
<li><code class="docutils literal"><span class="pre">ignore_radicals</span></code> : do not consider atom radicals while searching</li>
</ul>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;alter ignore_charges&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="ow">in</span> <span class="n">rxn</span><span class="o">.</span><span class="n">iterateMolecules</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Atom </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">atom</span><span class="o">.</span><span class="n">atomMappingNumber</span><span class="p">())</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;alter ignore_charges ignore_valence&quot;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.clearAAM</span></code> method resets current atom-to-atom
mapping. Reaction atom has method <code class="docutils literal"><span class="pre">IndigoObject.atomMappingNumber</span></code> and
<code class="docutils literal"><span class="pre">IndigoObject.setAtomMappingNumber</span></code> to get and set atom-to-atom
mapping manually.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rxn</span><span class="o">.</span><span class="n">clearAAM</span><span class="p">();</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">saveSmiles</span><span class="p">(</span><span class="s2">&quot;rxn_noaam.smi&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">aam-timeout</span></code> indigo integer parameter (time in milliseconds)
corresponds for the AAM algorithm working time. The AAM method returns a
current state solution for a reaction when time is over.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;aam-timeout&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">automap</span><span class="p">(</span><span class="s2">&quot;discard&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">saveSmiles</span><span class="p">(</span><span class="s2">&quot;rxn_time.smi&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="calculating-properties">
<h2>Calculating Properties<a class="headerlink" href="#calculating-properties" title="Permalink to this headline">¶</a></h2>
<p>The following <code class="docutils literal"><span class="pre">IndigoObject</span></code> methods can be applied to a molecule or
query molecule:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">countAtoms</span></code> — returns the number of atoms, including pseudoatoms
and R-sites.</li>
<li><code class="docutils literal"><span class="pre">countPseudoatoms</span></code> — returns the number of pseudoatoms.</li>
<li><code class="docutils literal"><span class="pre">countRSites</span></code> — returns the number of R-sites.</li>
<li><code class="docutils literal"><span class="pre">coundBonds</span></code> — returns the number of bonds.</li>
<li><code class="docutils literal"><span class="pre">grossFormula</span></code> — returns a string with the gross formula.</li>
<li><code class="docutils literal"><span class="pre">molecularWeight</span></code> — returns the molecular weight (a floating-point
number).</li>
<li><code class="docutils literal"><span class="pre">mostAbundantMass</span></code> — returns the “most abundant isotopes mass” (a
floating-point number).</li>
<li><code class="docutils literal"><span class="pre">monoisotopicMass</span></code> — returns the monoisotopic mass (a
floating-point number).</li>
<li><code class="docutils literal"><span class="pre">hasCoord</span></code> — returns <code class="docutils literal"><span class="pre">true</span></code> if the given molecule has
coordinates, <code class="docutils literal"><span class="pre">false</span></code> otherwise.</li>
<li><code class="docutils literal"><span class="pre">hasZCoord</span></code> — returns <code class="docutils literal"><span class="pre">true</span></code> if the given molecule has 3D
coordinates, <code class="docutils literal"><span class="pre">false</span></code> otherwise.</li>
<li><code class="docutils literal"><span class="pre">isChiral</span></code> — returns <code class="docutils literal"><span class="pre">true</span></code> if the molecule was loaded from a
Molfile, and if it had the ‘Chiral’ flag set.</li>
<li><code class="docutils literal"><span class="pre">countHeavyAtoms</span></code> — returns the number of atoms in the molecule,
excluding hydrogen atoms. Hydrogen isotopes are excluded too.</li>
<li><code class="docutils literal"><span class="pre">countImplicitHydrogens</span></code> — returns the total number of implicit
hydrogens in the molecule.</li>
<li><code class="docutils literal"><span class="pre">countHydrogens</span></code> — returns the total number of hydrogens in the
molecule (implicit hydrogens included, hydrogen isotopes included).</li>
<li><code class="docutils literal"><span class="pre">countSSSR</span></code> — returns the total number of cycles in the Smallest
Set of Smallest Rings (SSSR).</li>
</ul>
<div class="section" id="molecule-validation">
<h3>Molecule Validation<a class="headerlink" href="#molecule-validation" title="Permalink to this headline">¶</a></h3>
<p>Molecule validation can be done using the following methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">checkBadValence</span></code></li>
<li><code class="docutils literal"><span class="pre">checkAmbiguousH</span></code></li>
</ul>
<p>These functions returns non-empty string description of found issues, or
empty string if molecule is correct.</p>
</div>
<div class="section" id="working-with-connected-components">
<h3>Working with Connected Components<a class="headerlink" href="#working-with-connected-components" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal"><span class="pre">countComponents</span></code> method to calculate the number of
connected components in a structure. Via the <code class="docutils literal"><span class="pre">componentIndex</span></code> method,
you can obtain the number of the component to which the given atom
belongs. Also, you can obtain the whole “component” object via the
<code class="docutils literal"><span class="pre">component</span></code> method. You can also iterate over the components using the
<code class="docutils literal"><span class="pre">iterateComponents</span></code> method.</p>
<p>The “component” objects respond to the <code class="docutils literal"><span class="pre">countAtoms</span></code>, <code class="docutils literal"><span class="pre">countBonds</span></code>,
<code class="docutils literal"><span class="pre">iterateAtoms</span></code>, and <code class="docutils literal"><span class="pre">iterateBonds</span></code> calls. However, they can not be
used as molecules. If you want to have a separate molecule representing
a connected component, you should <code class="docutils literal"><span class="pre">clone</span></code> it.</p>
<p><strong>Note:</strong> The numbering of the components in zero-based.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;%d components\n&quot;</span><span class="o">,</span> <span class="n">mol</span><span class="o">.</span><span class="na">countComponents</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateComponents</span><span class="o">())</span>
<span class="o">{</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">comp</span><span class="o">.</span><span class="na">clone</span><span class="o">().</span><span class="na">smiles</span><span class="o">());</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;component %d: %d atoms, %d bonds\n&quot;</span><span class="o">,</span> <span class="n">comp</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">comp</span><span class="o">.</span><span class="na">countAtoms</span><span class="o">(),</span> <span class="n">comp</span><span class="o">.</span><span class="na">countBonds</span><span class="o">());</span>

   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">comp</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>

<span class="o">}</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">atom</span><span class="o">.</span><span class="na">componentIndex</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">component</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">iterateAtoms</span><span class="o">())</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;{0} components&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="p">.</span><span class="n">countComponents</span><span class="p">());</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">comp</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateComponents</span><span class="p">())</span>
<span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">comp</span><span class="p">.</span><span class="n">clone</span><span class="p">().</span><span class="n">smiles</span><span class="p">());</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;component {0}: {0} atoms, {0} bonds\n&quot;</span><span class="p">,</span> <span class="n">comp</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">comp</span><span class="p">.</span><span class="n">countAtoms</span><span class="p">(),</span> <span class="n">comp</span><span class="p">.</span><span class="n">countBonds</span><span class="p">());</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">comp</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>

<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">atom</span><span class="p">.</span><span class="n">componentIndex</span><span class="p">());</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">component</span><span class="p">(</span><span class="m">0</span><span class="p">).</span><span class="n">iterateAtoms</span><span class="p">())</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">countComponents</span><span class="p">(),</span> <span class="s1">&#39;components&#39;</span>

<span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateComponents</span><span class="p">():</span>
  <span class="k">print</span> <span class="n">comp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
  <span class="k">print</span> <span class="s2">&quot;component </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2"> atoms, </span><span class="si">%d</span><span class="s2"> bonds</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">comp</span><span class="o">.</span><span class="n">countAtoms</span><span class="p">(),</span> <span class="n">comp</span><span class="o">.</span><span class="n">countBonds</span><span class="p">())</span>
  <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
    <span class="k">print</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>

<span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
  <span class="k">print</span> <span class="n">atom</span><span class="o">.</span><span class="n">compomentIndex</span><span class="p">()</span>

<span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
  <span class="k">print</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="canonical-smiles">
<h3>Canonical SMILES<a class="headerlink" href="#canonical-smiles" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">IndigoObject.canonicalSmiles</span></code> method computes the canonical SMILES
(also known as absolute SMILES) string for either molecule or reaction.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mol</span><span class="o">.</span><span class="na">canonicalSmiles</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rxn</span><span class="o">.</span><span class="na">canonicalSmiles</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">mol</span><span class="p">.</span><span class="n">canonicalSmiles</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">rxn</span><span class="p">.</span><span class="n">canonicalSmiles</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">canonicalSmiles</span><span class="p">()</span>
<span class="k">print</span> <span class="n">rxn</span><span class="o">.</span><span class="n">canonicalSmiles</span><span class="p">()</span>
</pre></div>
</div>
<p>Please see the <a class="reference internal" href="../examples/calculating-properties.html#indigo-example-canonical-smiles"><span class="std std-ref">Canonical Smiles</span></a> for detailed examples</p>
</div>
<div class="section" id="attachment-points">
<h3>Attachment points<a class="headerlink" href="#attachment-points" title="Permalink to this headline">¶</a></h3>
<p>Every molecule can have many attachment points. They are grouped by
order - the number of connections. For example, a molecule can have 2
attachment points with order 1, and 3 attachment points with order 2.
The following methods of <code class="docutils literal"><span class="pre">IndigoObject</span></code> for a molecule are available
for working with attachment points:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">clearAttachmentPoints</span></code> resets all the attachment points.</li>
<li><code class="docutils literal"><span class="pre">countAttachmentPoints</span></code> returns maximal order of attachment points.</li>
<li><code class="docutils literal"><span class="pre">iterateAttachmentPoints(order)</span></code> iterates atoms corresponding to the
attachment points with the same specified order.</li>
</ul>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">countAttachmentPoints</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Number of attachment points: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
<span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateAttachmentPoints</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">   Index: </span><span class="si">%d</span><span class="s2">. Order </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">order</span><span class="p">))</span>
 <span class="n">mol</span><span class="o">.</span><span class="n">clearAttachmentPoints</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="layout-2d-coordinates">
<h3>Layout (2D coordinates)<a class="headerlink" href="#layout-2d-coordinates" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.layout</span></code> method performs the cleanup of the object it
is applied to by computing atoms 2D coordinates.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">layout</span><span class="p">();</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="aromaticity">
<h3>Aromaticity<a class="headerlink" href="#aromaticity" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.aromatize</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.dearomatize</span></code> methods
convert molecules/reactions to aromatic and Kekule forms respectively.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mol1</span><span class="o">.</span><span class="n">dearomatize</span><span class="p">();</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">aromatize</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="implicit-and-explicit-hydrogens">
<h3>Implicit and Explicit Hydrogens<a class="headerlink" href="#implicit-and-explicit-hydrogens" title="Permalink to this headline">¶</a></h3>
<p>Indigo does not change the representation of the hydrogens
automatically. If the hydrogens in the input structure or reaction are
implicit (this is usually the case), Indigo does not add the missing
hydrogens to the structure or reaction. If some (or all) of hydrogens in
the input are explicitly drawn, Indigo does not remove them.</p>
<p>You can force folding (i.e. removal) or unfolding (i.e. addition) the
hydrogens of a molecule or reaction by calling
<code class="docutils literal"><span class="pre">IndigoObject.foldHydrogens</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.unfoldHydrogens</span></code>
methods.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">unfoldHydrogens</span><span class="p">();</span>
<span class="n">mol</span><span class="o">.</span><span class="n">foldHydrogens</span><span class="p">();</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">unfoldHydrogens</span><span class="p">();</span>
<span class="n">rxn</span><span class="o">.</span><span class="n">foldHydrogens</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="stereochemistry">
<h3>Stereochemistry<a class="headerlink" href="#stereochemistry" title="Permalink to this headline">¶</a></h3>
<p>The following methods of <code class="docutils literal"><span class="pre">IndigoObject</span></code> are available for accessing
molecule’s stereo configuration:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">countStereocenters</span></code> returns the number of the chiral atoms in a
molecule</li>
<li><code class="docutils literal"><span class="pre">iterateStereocenters</span></code> returns an iterator for molecule’s atoms
that are stereocenters</li>
<li><code class="docutils literal"><span class="pre">countAlleneCenters</span></code> returns the number of allene-like stereo
fragments</li>
<li><code class="docutils literal"><span class="pre">iterateAlleneCenters</span></code> returns an iterator for molecule’s atoms
that are centers of allene fragments (the middle ‘C’ in ‘C=C=C’)</li>
<li><code class="docutils literal"><span class="pre">bondStereo</span></code> returns one of the following constants:<ul>
<li><code class="docutils literal"><span class="pre">Indigo.UP</span></code> — stereo “up” bond</li>
<li><code class="docutils literal"><span class="pre">Indigo.DOWN</span></code> — stereo “down” bond</li>
<li><code class="docutils literal"><span class="pre">Indigo.EITHER</span></code> — stereo “either” bond</li>
<li><code class="docutils literal"><span class="pre">Indigo.CIS</span></code> — “Cis” double bond</li>
<li><code class="docutils literal"><span class="pre">Indigo.TRANS</span></code> — “Trans” double bond</li>
<li>zero — not a stereo bond of any kind</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">stereocenterType</span></code> returns one of the following constants:<ul>
<li><code class="docutils literal"><span class="pre">Indigo.ABS</span></code> — “absolute” stereocenter</li>
<li><code class="docutils literal"><span class="pre">Indigo.OR</span></code> — “or” stereocenter</li>
<li><code class="docutils literal"><span class="pre">Indigo.AND</span></code> — “and” stereocenter</li>
<li><code class="docutils literal"><span class="pre">Indigo.EITHER</span></code> — “any” stereocenter</li>
<li>zero — not a stereocenter</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">invertStereo</span></code> inverts the stereo configuration of an atom</li>
<li><code class="docutils literal"><span class="pre">resetStereo</span></code> resets the stereo configuration of an atom or a bond</li>
<li><code class="docutils literal"><span class="pre">changeStereocenterType(newType)</span></code> changes current stereocenter type
to a specified type</li>
<li><code class="docutils literal"><span class="pre">addStereocenter(type,</span> <span class="pre">idx1,</span> <span class="pre">idx2,</span> <span class="pre">idx3,</span> <span class="pre">[idx4])</span></code> adds new
stereocenter build on a atom pyramid with a specified atom indices</li>
<li><code class="docutils literal"><span class="pre">clearStereocenters</span></code> resets the chiral configurations of a
molecule’s atoms</li>
<li><code class="docutils literal"><span class="pre">clearAlleneCenters</span></code> resets the chiral configurations of a
molecule’s allene-like fragments</li>
<li><code class="docutils literal"><span class="pre">clearCisTrans</span></code> resets the cis-trans configurations of a molecule’s
bonds</li>
</ul>
<p>The following methods are useful for keeping cis-trans stereochemistry
intact when converting to/from SMILES:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">resetSymmetricCisTrans</span></code> can be called on a molecule loaded from a
Molfile or CML. After this call, the cis-trans configurations remain
only on nonsymmetric cis-trans bonds. The method returns the number
of bonds that have been reset.</li>
<li><code class="docutils literal"><span class="pre">markEitherCisTrans</span></code> can be called prior to saving a molecule
loaded from SMILES to Molfile format. It guarantees that the bonds
that have no cis-trans configuration in SMILES will not have a
cis-trans configuration in the resulting Molfile.</li>
</ul>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadMolecule</span><span class="o">(</span><span class="s">&quot;chiral.mol&quot;</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">output</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;%d chiral atoms\n&quot;</span><span class="o">,</span> <span class="n">mol</span><span class="o">.</span><span class="na">countStereocenters</span><span class="o">());</span>
<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateStereocenters</span><span class="o">())</span>
<span class="o">{</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;atom %d -- stereocenter type %d\n&quot;</span><span class="o">,</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">atom</span><span class="o">.</span><span class="na">stereocenterType</span><span class="o">());</span>
   <span class="n">atom</span><span class="o">.</span><span class="na">invertStereo</span><span class="o">();</span>
<span class="o">}</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateBonds</span><span class="o">())</span>
   <span class="k">if</span> <span class="o">(</span><span class="n">bond</span><span class="o">.</span><span class="na">bondStereo</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;bond %d -- stereo type %d\n&quot;</span><span class="o">,</span> <span class="n">bond</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">bond</span><span class="o">.</span><span class="na">bondStereo</span><span class="o">());</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mol</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
<span class="n">mol</span><span class="o">.</span><span class="na">clearStereocenters</span><span class="o">();</span>
<span class="n">mol</span><span class="o">.</span><span class="na">clearCisTrans</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mol</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;chiral.mol&quot;</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;{0} chiral atoms\n&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="p">.</span><span class="n">countStereocenters</span><span class="p">());</span>
<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateStereocenters</span><span class="p">())</span>
<span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;atom {0} -- stereocenter type {1}\n&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">atom</span><span class="p">.</span><span class="n">stereocenterType</span><span class="p">());</span>
   <span class="n">atom</span><span class="p">.</span><span class="n">invertStereo</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateBonds</span><span class="p">())</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">bond</span><span class="p">.</span><span class="n">bondStereo</span><span class="p">()</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
     <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;bond {0} -- stereo type {1}\n&quot;</span><span class="p">,</span> <span class="n">bond</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">bond</span><span class="p">.</span><span class="n">bondStereo</span><span class="p">());</span>

<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">mol</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
<span class="n">mol</span><span class="p">.</span><span class="n">clearStereocenters</span><span class="p">();</span>
<span class="n">mol</span><span class="p">.</span><span class="n">clearCisTrans</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">mol</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;chiral.mol&quot;</span><span class="p">);</span>

<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">countStereocenters</span><span class="p">(),</span> <span class="s2">&quot;chiral atoms&quot;</span>
<span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateStereocenters</span><span class="p">():</span>
   <span class="k">print</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;-- stereocenter type&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">stereocenterType</span><span class="p">()</span>
   <span class="n">atom</span><span class="o">.</span><span class="n">invertStereo</span><span class="p">();</span>

<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">():</span>
   <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">bondStereo</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
     <span class="k">print</span> <span class="s2">&quot;bond&quot;</span><span class="p">,</span> <span class="n">bond</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;-- stereo type&quot;</span><span class="p">,</span> <span class="n">bond</span><span class="o">.</span><span class="n">bondStereo</span><span class="p">()</span>

<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">clearStereocenters</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">clearCisTrans</span><span class="p">()</span>
<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">stereocenterGroup</span></code> and <code class="docutils literal"><span class="pre">setStereocenterGroup</span></code> method to get/set stereocenter group:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Load structure</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMoleculeFromFile</span><span class="p">(</span><span class="s1">&#39;../release-notes/1.1.x/data/stereogroups.mol&#39;</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s1">&#39;render-comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Before&#39;</span><span class="p">)</span>
<span class="n">indigoRenderer</span><span class="o">.</span><span class="n">renderToFile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;result_1.png&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">iterateStereocenters</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;atom index =&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;group =&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">stereocenterGroup</span><span class="p">()</span>

<span class="n">m</span><span class="o">.</span><span class="n">getAtom</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">changeStereocenterType</span><span class="p">(</span><span class="n">Indigo</span><span class="o">.</span><span class="n">OR</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">getAtom</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setStereocenterGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">getAtom</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">setStereocenterGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s1">&#39;render-comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Stereocenter groups and types were changed&#39;</span><span class="p">)</span>
<span class="n">indigoRenderer</span><span class="o">.</span><span class="n">renderToFile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;result_2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f881.svg"><img alt="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f881.svg" src="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f881.svg" /></a>
<a class="reference internal image-reference" href="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f882.svg"><img alt="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f882.svg" src="../../_images/indigorenderer_e2b61a77b9a68f5aeeca12da245bb3baef011f882.svg" /></a>
<div class="line"><br /></div>
Output:<div class="output highlight-default"><div class="highlight"><pre><span></span><span class="n">atom</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">group</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">atom</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">group</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">atom</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">5</span> <span class="n">group</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">markStereobonds</span></code> method set up/down bond marks if a stereoconfiguration were changed manually, or if it should be reset:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMoleculeFromFile</span><span class="p">(</span><span class="s1">&#39;../release-notes/1.1.x/data/stereobonds.mol&#39;</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s1">&#39;render-comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Before&#39;</span><span class="p">)</span>
<span class="n">indigoRenderer</span><span class="o">.</span><span class="n">renderToFile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;result_1.png&#39;</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">markStereobonds</span><span class="p">()</span>

<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s1">&#39;render-comment&#39;</span><span class="p">,</span> <span class="s1">&#39;After&#39;</span><span class="p">)</span>
<span class="n">indigoRenderer</span><span class="o">.</span><span class="n">renderToFile</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;result_2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c591.svg"><img alt="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c591.svg" src="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c591.svg" /></a>
<a class="reference internal image-reference" href="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c592.svg"><img alt="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c592.svg" src="../../_images/indigorenderer_b49732821eb4b39738446ec8bd0d91f726c22c592.svg" /></a>
</div>
<div class="section" id="enumeration-of-submolecules">
<h3>Enumeration of Submolecules<a class="headerlink" href="#enumeration-of-submolecules" title="Permalink to this headline">¶</a></h3>
<p>Indigo provides methods to enumerate submolecules of different kinds,
namely:</p>
<ul class="simple">
<li>Smallest Set of Smallest Rings (SSSR) — <code class="docutils literal"><span class="pre">iterateSSSR</span></code>.</li>
<li>All rings of size within a given interval — <code class="docutils literal"><span class="pre">iterateRings</span></code>. The
method accepts the minimum and maximum amounts of the rings’ atoms.</li>
<li>All subtrees of size within a given interval — <code class="docutils literal"><span class="pre">iterateSubtrees</span></code>.
The method accepts the minimum and maximum amounts of the subtrees’
atoms.</li>
<li>All edge submolecules of size within a given interval —
<code class="docutils literal"><span class="pre">iterateEdgeSubmolecules</span></code>. The method accepts the minimum and
maximum amounts of the submolecules’ edges.</li>
</ul>
<p>The “submolecule” objects returned by these methods respond to the
<code class="docutils literal"><span class="pre">countAtoms</span></code>, <code class="docutils literal"><span class="pre">countBonds</span></code>, <code class="docutils literal"><span class="pre">iterateAtoms</span></code>, and <code class="docutils literal"><span class="pre">iterateBonds</span></code>
calls. However, they can not be used as molecules. If you want to have a
separate molecule representing the obtained submolecule, you should
<code class="docutils literal"><span class="pre">clone</span></code> it.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">submol</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateEdgeSubmolecules</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">mol</span><span class="o">.</span><span class="na">countBonds</span><span class="o">())</span>
<span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;submolecule #%d: %s\n&quot;</span><span class="o">,</span> <span class="n">submol</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">submol</span><span class="o">.</span><span class="na">clone</span><span class="o">().</span><span class="na">smiles</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">item</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;%d &quot;</span><span class="o">,</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="o">:</span> <span class="n">item</span><span class="o">.</span><span class="na">iterateBonds</span><span class="o">())</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;%d &quot;</span><span class="o">,</span> <span class="n">bond</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateEdgeSubmolecules</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">mol</span><span class="p">.</span><span class="n">countAtoms</span><span class="p">()))</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;{0} {1}&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">item</span><span class="p">.</span><span class="n">clone</span><span class="p">().</span><span class="n">smiles</span><span class="p">());</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">item</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
    <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;{0} &quot;</span><span class="p">,</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="k">in</span> <span class="n">item</span><span class="p">.</span><span class="n">iterateBonds</span><span class="p">())</span>
    <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;{0} &quot;</span><span class="p">,</span> <span class="n">bond</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">submol</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateEdgeSubmolecules</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">countBonds</span><span class="p">()):</span>
  <span class="k">print</span> <span class="s2">&quot;submolecule&quot;</span><span class="p">,</span> <span class="n">submol</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">submol</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
  <span class="k">print</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">()]</span>
  <span class="k">print</span> <span class="p">[</span><span class="n">bond</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="section" id="enumeration-of-tautomers">
<h3>Enumeration of Tautomers<a class="headerlink" href="#enumeration-of-tautomers" title="Permalink to this headline">¶</a></h3>
<p>Indigo provides a method to enumerate tautomers of a selected molecule.
Currently there are two algorithms to enumerate tautomers: based on InChI code and based on a set of reaction SMARTS rules.</p>
<p>The <code class="docutils literal"><span class="pre">iterateTautomers</span></code> method returns an iterator for tautomers. It accepts a molecule and options as parameters.
There are two possible options: <code class="docutils literal"><span class="pre">INCHI</span></code> to use method based on <a class="reference external" href="../../resources.html#inchi-code">InChI code</a>, and <code class="docutils literal"><span class="pre">RSMARTS</span></code> to use <a class="reference external" href="../../resources.html#rsmarts-rules">reaction SMARTS templates</a>:</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">tautomer</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateTautomers</span><span class="o">(</span><span class="n">molecule</span><span class="o">,</span> <span class="s">&quot;RSMARTS&quot;</span><span class="o">)</span>
<span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;tautomer %d: %s\n&quot;</span><span class="o">,</span> <span class="n">tautomer</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">tautomer</span><span class="o">.</span><span class="na">clone</span><span class="o">().</span><span class="na">smiles</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateTautomers</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s">&quot;RSMARTS&quot;</span><span class="p">))</span>
<span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;tautomer {0}: {1}&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">item</span><span class="p">.</span><span class="n">clone</span><span class="p">().</span><span class="n">smiles</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">tautomer</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateTautomers</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s1">&#39;RSMARTS&#39;</span><span class="p">):</span>
  <span class="k">print</span> <span class="s2">&quot;tautomer&quot;</span><span class="p">,</span> <span class="n">tautomer</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">tautomer</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
<p>Please see the <a class="reference internal" href="../examples/calculating-properties.html#indigo-example-tautomer-enumeration"><span class="std std-ref">Enumeration of Tautomers</span></a> for detailed examples</p>
</div>
<div class="section" id="sgroups">
<h3>SGroups<a class="headerlink" href="#sgroups" title="Permalink to this headline">¶</a></h3>
<p>In a molecule loaded from a Molfile, arbitrary subsets of a its atoms
and bonds can be joined in S-groups. There are many kinds of S-groups,
Indigo supports all described in the format:</p>
<ul class="simple">
<li>generic SGroup (GEN)</li>
<li>abbreviation (superatom) (SUP)</li>
<li>structure repeating unit (SRU)</li>
<li>multiple SGroup (MUL)</li>
<li>data SGroup (DAT)</li>
<li>monomer SGroup (MON)</li>
<li>mer SGroup (MER)</li>
<li>copolymer SGroup (COP)</li>
<li>crosslink SGroup (CRO)</li>
<li>modification SGroup (MOD)</li>
<li>graft SGroup (GRA)</li>
<li>component SGroup (COM)</li>
<li>mixture SGroup (MIX)</li>
<li>formulation SGroup (FOR)</li>
<li>any polymer SGroup (ANY)</li>
</ul>
<p>The following methods of <code class="docutils literal"><span class="pre">IndigoObject</span></code> are available for reading
molecule’s groups:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">countGenericSGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">countSuperatoms</span></code></li>
<li><code class="docutils literal"><span class="pre">countRepeatingUnits</span></code></li>
<li><code class="docutils literal"><span class="pre">countMultipleGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">countDataSGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateGenericSGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateSuperatoms</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateRepeatingUnits</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateMultipleGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateDataSGroups</span></code></li>
<li><code class="docutils literal"><span class="pre">getSuperatom(index)</span></code></li>
<li><code class="docutils literal"><span class="pre">getDataSGroup(index)</span></code></li>
</ul>
<p>The iterator methods return “group” objects. Each “group” object
responds to <code class="docutils literal"><span class="pre">IndigoObject.iterateAtoms</span></code> and
<code class="docutils literal"><span class="pre">IndigoObject.iterateBonds</span></code> methods.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">dsg</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateDataSGroups</span><span class="o">())</span>
<span class="o">{</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;data sgroup &quot;</span> <span class="o">+</span> <span class="n">dsg</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">dsg</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;  atom &quot;</span> <span class="o">+</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">dsg</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateDataSGroups</span><span class="p">())</span>
<span class="p">{</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;data sgroup &quot;</span> <span class="p">+</span> <span class="n">dsg</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">dsg</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;  atom &quot;</span> <span class="p">+</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dsg</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateDataSGroups</span><span class="p">():</span>
   <span class="k">print</span> <span class="s2">&quot;data sgroup&quot;</span><span class="p">,</span> <span class="n">dsg</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">dsg</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
      <span class="k">print</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also add data SGroups to an existing structure using
<code class="docutils literal"><span class="pre">IndigoObject.addDataSGroup()</span></code> method. It returns the added group. By
default, the data SGroup is added in “attached” mode — that is, the data
is attached to each of the group’s atoms. To make the data SGroup
detached, you can call the <code class="docutils literal"><span class="pre">IndigoObject.setDataSGroupXY</span></code> method of
the data SGroup object. To get a description of a data SGroup use method
<code class="docutils literal"><span class="pre">IndigoObject.description()</span></code>.</p>
<p>To add a superatom use <code class="docutils literal"><span class="pre">IndigoObject.addSuperatom()</span></code> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">addSuperatom</span><span class="p">(</span><span class="n">list_with_atom_indices</span><span class="p">,</span> <span class="s2">&quot;Abbreviation&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>New set of methods is available for manipulation with S-groups.
You can create new S-group using “mapping” object received from matcher:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IndigoObject.createSGroup</span></code></li>
</ul>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">substructureMatcher</span><span class="o">(</span><span class="n">mol</span><span class="o">).</span><span class="na">match</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">match</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
<span class="o">{</span>
   <span class="n">IndigoObject</span> <span class="n">sgroup</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="na">createSGroup</span><span class="o">(</span><span class="s">&quot;SUP&quot;</span><span class="o">,</span> <span class="n">match</span><span class="o">,</span> <span class="s">&quot;Asx&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">).</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">IndigoObject</span> <span class="n">sgroup</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">createSGroup</span><span class="p">(</span><span class="s">&quot;SUP&quot;</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="s">&quot;Asx&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
   <span class="n">sgroup</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">createSGroup</span><span class="p">(</span><span class="s2">&quot;SUP&quot;</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="s2">&quot;Asx&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can get and set different S-group’s properties using the next methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">getSGroupType</span></code> - returns S-group type</li>
<li><code class="docutils literal"><span class="pre">getSGroupIndex</span></code> - returns S-group index</li>
<li><code class="docutils literal"><span class="pre">setSGroupData</span></code> - accepts S-group data (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupCoords</span></code> accepts S-group coordinates, x and y values (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupDescription</span></code>- accepts S-group data field units or format (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupFieldName</span></code> - accepts S-group data name (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupQueryCode</span></code> - accepts S-group data query code (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupQueryOper</span></code> - accepts S-group data query operation (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupDisplay</span></code> - accepts S-group data display option (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupLocation</span></code> - accepts S-group data display location (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupTag</span></code> - accepts S-group data tag (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupTagAlign</span></code> - accepts S-group data tag alignment (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupDataType</span></code> - accepts S-group data type (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupXCoord</span></code> - accepts S-group x coordinate (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupYCoord</span></code> - accepts S-group y coordinate (for S-groups of “DAT” type)</li>
<li><code class="docutils literal"><span class="pre">getSGroupClass</span></code> - returns S-group class name (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupClass</span></code> - accepts S-group class name (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">getSGroupName</span></code> - returns S-group label (for S-groups of “SUP” and “SRU” types)</li>
<li><code class="docutils literal"><span class="pre">setSGroupName</span></code> - accepts S-group label (for S-groups of “SUP” and “SRU” types)</li>
<li><code class="docutils literal"><span class="pre">getSGroupNumCrossBonds</span></code> - returns number of crossing bonds for sgroup</li>
<li><code class="docutils literal"><span class="pre">addSGroupAttachmentPoint</span></code> - accepts attachment point’s description and creates it (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">deleteSGroupAttachmentPoint</span></code> - accepts attachment point’s index and removes it (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">getSGroupDisplayOption</span></code> - returns display option for sgroup (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupDisplayOption</span></code> - accepts display option for sgroup (for S-groups of “SUP” type)</li>
<li><code class="docutils literal"><span class="pre">getSGroupMultiplier</span></code> - returns multiplier value for sgroup (for S-groups of “MUL” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupMultiplier</span></code> - accepts multiplier value for sgroup (for S-groups of “MUL” type)</li>
<li><code class="docutils literal"><span class="pre">setSGroupBrackets</span></code> - accepts bracket style and brackets coordinates for sgroup (for S-groups of “GEN”,”MUL” and “SRU” types)</li>
</ul>
<p><strong>Note</strong>: All properties and its values correspond to Molfile format.</p>
<p>Python examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sg</span><span class="o">.</span><span class="n">setSGroupClass</span><span class="p">(</span><span class="s2">&quot;AA&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">getSGroupName</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">getSGroupClass</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">getSGroupNumCrossBonds</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">getSGroupDisplayOption</span><span class="p">())</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupName</span><span class="p">(</span><span class="s2">&quot;As&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupDisplayOption</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mp</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">getSGroupMultiplier</span><span class="p">()</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupMultiplier</span><span class="p">(</span><span class="n">mp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupBrackets</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupData</span><span class="p">(</span><span class="s2">&quot;Test Data S-group&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupCoords</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupDescription</span><span class="p">(</span><span class="s2">&quot;SGroup Description (FIELDINFO)&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupFieldName</span><span class="p">(</span><span class="s2">&quot;SGroup (FIELDNAME)&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupQueryCode</span><span class="p">(</span><span class="s2">&quot;SGroup (QUERYTYPE)&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupQueryOper</span><span class="p">(</span><span class="s2">&quot;SGroup (QUERYOP)&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupDisplay</span><span class="p">(</span><span class="s2">&quot;attached&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupLocation</span><span class="p">(</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupTag</span><span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupTagAlign</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupDataType</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupXCoord</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">setSGroupYCoord</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can find in the <code class="docutils literal"><span class="pre">IndigoObject</span></code> S-groups using different criteria
with corresponding values in S-group properties by type, by name, by class, by atoms or crossing bonds
included in S-group:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">findSGroups</span></code>  - it accepts key and value for search and retuns iterator for collection of found sgroups</li>
</ul>
<p>Currently available keys are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SG_TYPE</span></code> - find sgroups by type</li>
<li><code class="docutils literal"><span class="pre">SG_CLASS</span></code> - find sgroups by class</li>
<li><code class="docutils literal"><span class="pre">SG_LABEL</span></code> - find sgroups by name</li>
<li><code class="docutils literal"><span class="pre">SG_DISPLAY_OPTION</span></code> - find sgroups by display option</li>
<li><code class="docutils literal"><span class="pre">SG_BRACKET_STYLE</span></code> - find sgroups by bracket style</li>
<li><code class="docutils literal"><span class="pre">SG_DATA</span></code> - find sgroups which contains corresponding string in data field</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_NAME</span></code> - find sgroups by data name</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_TYPE</span></code> - find sgroups by data type</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_DESCRIPTION</span></code> - find sgroups by data description</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_DISPLAY</span></code> - find sgroups by data display option</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_LOCATION</span></code> - find sgroups by data location</li>
<li><code class="docutils literal"><span class="pre">SG_DATA_TAG</span></code> - find sgroups by data tag</li>
<li><code class="docutils literal"><span class="pre">SG_QUERY_CODE</span></code> - find sgroups by query code</li>
<li><code class="docutils literal"><span class="pre">SG_QUERY_OPER</span></code> - find sgroups by query operation</li>
<li><code class="docutils literal"><span class="pre">SG_PARENT</span></code> - find sgroups by parent sgroup</li>
<li><code class="docutils literal"><span class="pre">SG_CHILD</span></code> - find sgroups by children sgroup</li>
<li><code class="docutils literal"><span class="pre">SG_ATOMS</span></code> - find sgroups containing list of atoms</li>
<li><code class="docutils literal"><span class="pre">SG_BONDS</span></code> - find sgroups contating list of crossing bonds</li>
</ul>
<p>Please see the <a class="reference internal" href="../examples/calculating-properties.html#indigo-example-sgroups-search"><span class="std std-ref">Sgroups search</span></a> for detailed examples</p>
<p>S-group can be removed from the <code class="docutils literal"><span class="pre">IndigoObject</span></code> using <code class="docutils literal"><span class="pre">remove</span></code> method. In that case just description of
corresponding S-group will be removed (the atoms and bonds remain).</p>
</div>
<div class="section" id="tgroups">
<h3>TGroups<a class="headerlink" href="#tgroups" title="Permalink to this headline">¶</a></h3>
<p>Indigo supports the hybrid representation (SCSR) for a molecule loaded from a V3000 Molfile.
SCSR uses TEMPLATE blocks to represent residues and this representation is widely used for biological sequences.</p>
<p>There are methods for transformation SCSR into full CTAB form and vise versa:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">transformSCSRtoCTAB</span></code> - transforms SCSR into full CTAB representation (templates are transformed into S-groups)</li>
<li><code class="docutils literal"><span class="pre">transformCTABtoSCSR</span></code> - transforms CTAB into SCSR (accepts templates collection and replaces matched fragments by pseudoatoms and corresponding templates)</li>
</ul>
<p>Examples of usage these methods are in corresponding <a class="reference external" href="../examples/scsr-transformations.html">Examples</a> section.</p>
</div>
<div class="section" id="alignment-of-atoms">
<h3>Alignment of Atoms<a class="headerlink" href="#alignment-of-atoms" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.alignAtoms</span></code> method can be used to calculate and
apply the transformation (scale + rotation + translation) of a
molecule so that some subset of its atoms will become as close as
possible to the desired positions. The method accepts an integer array
of atom indices and a float array of desired coordinates (three times
bigger that the array of indices, storing resired x,y,z coordinates for
each atom).</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">query</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadSmarts</span><span class="o">(</span><span class="s">&quot;[#7]1~[#6]~[#6]~[#7]~[#6]~[#6]2~[#6]~[#6]~[#6]~[#6]~[#6]~1~2&quot;</span><span class="o">);</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">atoms</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">query</span><span class="o">.</span><span class="na">countAtoms</span><span class="o">()];</span>
<span class="kt">float</span><span class="o">[]</span> <span class="n">xyz</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">float</span><span class="o">[</span><span class="n">query</span><span class="o">.</span><span class="na">countAtoms</span><span class="o">()</span> <span class="o">*</span> <span class="mi">3</span><span class="o">];</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">structure</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateSDFile</span><span class="o">(</span><span class="s">&quot;structures.sdf.gz&quot;</span><span class="o">))</span>
<span class="o">{</span>
   <span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">substructureMatcher</span><span class="o">(</span><span class="n">structure</span><span class="o">).</span><span class="na">match</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
   <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

   <span class="k">if</span> <span class="o">(</span><span class="n">structure</span><span class="o">.</span><span class="na">index</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">query</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
         <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">match</span><span class="o">.</span><span class="na">mapAtom</span><span class="o">(</span><span class="n">atom</span><span class="o">).</span><span class="na">xyz</span><span class="o">(),</span> <span class="mi">0</span><span class="o">,</span> <span class="n">xyz</span><span class="o">,</span> <span class="n">i</span><span class="o">++</span> <span class="o">*</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
   <span class="k">else</span>
   <span class="o">{</span>
      <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">query</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
         <span class="n">atoms</span><span class="o">[</span><span class="n">i</span><span class="o">++]</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="na">mapAtom</span><span class="o">(</span><span class="n">atom</span><span class="o">).</span><span class="na">index</span><span class="o">();</span>

      <span class="n">structure</span><span class="o">.</span><span class="na">alignAtoms</span><span class="o">(</span><span class="n">atoms</span><span class="o">,</span> <span class="n">xyz</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">query</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s">&quot;[#7]1~[#6]~[#6]~[#7]~[#6]~[#6]2~[#6]~[#6]~[#6]~[#6]~[#6]~1~2&quot;</span><span class="p">);</span>
<span class="kt">int</span><span class="p">[]</span> <span class="n">atoms</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="n">query</span><span class="p">.</span><span class="n">countAtoms</span><span class="p">()];</span>
<span class="kt">float</span><span class="p">[]</span> <span class="n">xyz</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">float</span><span class="p">[</span><span class="n">query</span><span class="p">.</span><span class="n">countAtoms</span><span class="p">()</span> <span class="p">*</span> <span class="m">3</span><span class="p">];</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">structure</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf.gz&quot;</span><span class="p">))</span>
<span class="p">{</span>
   <span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">structure</span><span class="p">).</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
   <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">structure</span><span class="p">.</span><span class="n">index</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">query</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
         <span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">).</span><span class="n">xyz</span><span class="p">(),</span> <span class="m">0</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">i</span><span class="p">++</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span>
   <span class="k">else</span>
   <span class="p">{</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">query</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
      <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">++]</span> <span class="p">=</span> <span class="n">match</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">).</span><span class="n">index</span><span class="p">();</span>

      <span class="n">structure</span><span class="p">.</span><span class="n">alignAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">xyz</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s2">&quot;[#7]1~[#6]~[#6]~[#7]~[#6]~[#6]2~[#6]~[#6]~[#6]~[#6]~[#6]~1~2&quot;</span><span class="p">);</span>
<span class="n">xyz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s2">&quot;structures.sdf.gz&quot;</span><span class="p">):</span>
  <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">structure</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
      <span class="n">xyz</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span><span class="o">.</span><span class="n">xyz</span><span class="p">())</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
      <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">())</span>
    <span class="n">structure</span><span class="o">.</span><span class="n">alignAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">xyz</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="inchi">
<h3>InChI<a class="headerlink" href="#inchi" title="Permalink to this headline">¶</a></h3>
<p>InChI support is done via IndigoInchi plugin. To work with the InChI
plugin in C#/Java/Python wrappers, one needs to create an instance of
IndigoInchi, passing an existing Indigo instance to it.</p>
<p>Use <code class="docutils literal"><span class="pre">IndigoInchi.loadMolecule</span></code> method to convert InChI strings to a
molecule, and <code class="docutils literal"><span class="pre">IndigoInchi.getInchi</span></code> method for the reverse operation.</p>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo_inchi</span> <span class="o">=</span> <span class="n">IndigoInchi</span><span class="p">(</span><span class="n">indigo</span><span class="p">);</span>

<span class="k">print</span><span class="p">(</span><span class="n">indigo_inchi</span><span class="o">.</span><span class="n">version</span><span class="p">())</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">indigo_inchi</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;InChI=1S/C10H20N2O2/c11-7-1-5-2-8(12)10(14)4-6(5)3-9(7)13/h5-10,13-14H,1-4,11-12H2&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">canonicalSmiles</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">indigo_inchi</span><span class="o">.</span><span class="n">getInchi</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">indigo_inchi</span><span class="o">.</span><span class="n">getWarning</span><span class="p">())</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;C1CCCCCCC1&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">indigo_inchi</span><span class="o">.</span><span class="n">getInchi</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="options">
<h4>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h4>
<p>You can pass any options supported by the official InChI library via
<code class="docutils literal"><span class="pre">inchi-options</span></code> option:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;inchi-options&quot;</span><span class="p">,</span> <span class="s2">&quot;/DoNotAddH /SUU /SLUUD&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>One can use both <code class="docutils literal"><span class="pre">-</span></code> and <code class="docutils literal"><span class="pre">/</span></code> prefix for them:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;inchi-options&quot;</span><span class="p">,</span> <span class="s2">&quot;-DoNotAddH /SUU -SLUUD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="standardize-of-molecule">
<h3>Standardize of Molecule<a class="headerlink" href="#standardize-of-molecule" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.standardize</span></code> method can be used to the “standardizing”
of the molecule or query (stereo, charges, geometry, valences, atoms and bonds properties)
in accordance with requirements. The list of applied modifications is defined by
options activated in Indigo (full list of available standardize options is described
in the corresponding <a class="reference external" href="../options/standardize.html">Options</a> section).</p>
<p><strong>Note:</strong> in the case of activation multiple options the order of applied modifications
corresponds to the order of the options in the list of available options</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;standardize-stereo&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;standardize-charges&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
<span class="n">mol</span><span class="o">.</span><span class="n">standardize</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="ionize-of-molecule">
<h3>Ionize of Molecule<a class="headerlink" href="#ionize-of-molecule" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.ionize</span></code> method can be used for building protonated/deprotonated form
of the molecule in accordance with pH and pH tolerance. pKa model for pKa estimation can be
defined using corresponding <a class="reference external" href="../options/pka.html">Options</a> section).</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;pKa-model&quot;</span><span class="p">,</span> <span class="s2">&quot;advanced&quot;</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;pKa-model-level&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;pKa-model-min-level&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">mol</span><span class="o">.</span><span class="n">ionize</span><span class="p">(</span><span class="n">pH</span><span class="p">,</span> <span class="n">ph_toll</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="pka">
<h3>pKa<a class="headerlink" href="#pka" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.getAcidPkaValue</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.getBasicPkaValue</span></code> method can be used for
estimation pKa values for individual atoms in a molecule. pKa model for pKa estimation can be
defined using corresponding <a class="reference external" href="../options/pka.html">Options</a> section).</p>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.buildPkaModel</span></code> method is used for building pKa model based on custom structures
set.</p>
<p>Java, C#, and Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">level</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">buildPkaModel</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;molecules/PkaModel.sdf&#39;</span><span class="p">)</span>

<span class="n">a_pka</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">getAcidPkaValue</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">b_pka</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">getBasicPkaValue</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cip-stereo-descriptors">
<h3>CIP Stereo Descriptors<a class="headerlink" href="#cip-stereo-descriptors" title="Permalink to this headline">¶</a></h3>
<p>Descriptors calculation is activated by corresponding Indigo option <code class="docutils literal"><span class="pre">molfile-saving-add-stereo-desc</span></code>
and descriptors are added into generated mol file as data S-groups with special name field
<code class="docutils literal"><span class="pre">INDIGO_CIP_DESC</span></code>. Setting Indigo option  <code class="docutils literal"><span class="pre">molfile-saving-add-stereo-desc</span></code> to 0 (or false) (the
default value) disables descriptors calculation and removes all such data S-groups during corresponding
mol file generation.</p>
<p>Please see the <a class="reference internal" href="../examples/calculating-properties.html#indigo-example-cip-descriptors"><span class="std std-ref">CIP Descriptors</span></a> for detailed examples.</p>
</div>
</div>
<div class="section" id="io">
<h2>IO<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reading-sdf-rdf-cml-multiline-smiles-files-cdx-binary">
<span id="indigo-api-io-reading-files"></span><h3>Reading SDF, RDF, CML, multiline SMILES files, CDX (binary)<a class="headerlink" href="#reading-sdf-rdf-cml-multiline-smiles-files-cdx-binary" title="Permalink to this headline">¶</a></h3>
<p>The following methods of the <code class="docutils literal"><span class="pre">Indigo</span></code> class can be used to enumerate
files with multiple molecules/reactions:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">iterateSDFile</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateRDFile</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateSmilesFile</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateCMLFile</span></code></li>
<li><code class="docutils literal"><span class="pre">iterateCDXFile</span></code></li>
</ul>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateSDFile</span><span class="o">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="o">))</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">grossFormula</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">))</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">grossFormula</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s2">&quot;structures.sdf&quot;</span><span class="p">):</span>
   <span class="k">print</span> <span class="n">item</span><span class="o">.</span><span class="n">grossFormula</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="indexed-access">
<h3>Indexed access<a class="headerlink" href="#indexed-access" title="Permalink to this headline">¶</a></h3>
<p>You can access items from SDF/RDF/CML/SMILES files by index, using the
<code class="docutils literal"><span class="pre">at</span></code> method. The numbering of the items is zero-based.</p>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">);</span>
<span class="n">String</span> <span class="n">s</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="m">15</span><span class="p">).</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> and <code class="docutils literal"><span class="pre">String</span></code> omitted.</p>
</div>
<div class="section" id="accessing-molecule-and-reaction-properties">
<h3>Accessing Molecule and Reaction Properties<a class="headerlink" href="#accessing-molecule-and-reaction-properties" title="Permalink to this headline">¶</a></h3>
<div class="section" id="names">
<h4>Names<a class="headerlink" href="#names" title="Permalink to this headline">¶</a></h4>
<p>Molecule or reaction name is associated with the first line of the
Molfile/Rxnfile the molecule/reaction was loaded from. In case it was
loaded from SMILES string, the word immediately following the SMILES
code is taken.</p>
<p><code class="docutils literal"><span class="pre">IndigoObject.name</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.setName</span></code> are the getter and
setter of the molecule/reaction name.</p>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">name</span> <span class="p">=</span> <span class="n">mol2</span><span class="p">.</span><span class="n">name</span><span class="p">();</span>
<span class="n">mol2</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="s">&quot;another name&quot;</span><span class="p">);</span>
<span class="n">mol2</span><span class="p">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;mol2.mol&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> and <code class="docutils literal"><span class="pre">String</span></code> omitted.</p>
</div>
<div class="section" id="sdf-rdf-cdx-properties">
<h4>SDF/RDF/CDX Properties<a class="headerlink" href="#sdf-rdf-cdx-properties" title="Permalink to this headline">¶</a></h4>
<p>The following methods are used to get the named properties of the
molecule/reaction loaded from an SDF or RDF or CDX file:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IndigoObject.hasProperty</span></code> (boolean) — checks if the object has the
given property.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.getProperty</span></code> (string) — returns the value of the
given property, or raises an error in case the object does not have
it.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.removeProperty</span></code> — removes the given property from the
object, or does nothing in case the object does not have it.</li>
<li><strong>Note:</strong> currently CDX annotations are used as CDX properties</li>
</ul>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateSDFile</span><span class="o">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="o">))</span>
   <span class="k">if</span> <span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">hasProperty</span><span class="o">(</span><span class="s">&quot;cdbregno&quot;</span><span class="o">))</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;cdbregno&quot;</span><span class="o">));</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">))</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">hasProperty</span><span class="p">(</span><span class="s">&quot;cdbregno&quot;</span><span class="p">))</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s">&quot;cdbregno&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s2">&quot;structures.sdf&quot;</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">hasProperty</span><span class="p">(</span><span class="s2">&quot;cdbregno&quot;</span><span class="p">):</span>
      <span class="k">print</span> <span class="n">item</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s2">&quot;cdbregno&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to iterate over all properties of a particular
record in SDF or RDF or CDX file.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateRDfile</span><span class="o">(</span><span class="s">&quot;reactions.rdf&quot;</span><span class="o">))</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">prop</span> <span class="o">:</span> <span class="n">item</span><span class="o">.</span><span class="na">iterateProperties</span><span class="o">())</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">prop</span><span class="o">.</span><span class="na">name</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">prop</span><span class="o">.</span><span class="na">rawData</span><span class="o">())</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateRDfile</span><span class="p">(</span><span class="s">&quot;reactions.rdf&quot;</span><span class="p">))</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">prop</span> <span class="k">in</span> <span class="n">item</span><span class="p">.</span><span class="n">iterateProperties</span><span class="p">())</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">prop</span><span class="p">.</span><span class="n">name</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot; : &quot;</span> <span class="p">+</span> <span class="n">prop</span><span class="p">.</span><span class="n">rawData</span><span class="p">())</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateRDFile</span><span class="p">(</span><span class="s2">&quot;reactions.rdf&quot;</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">iterateProperties</span><span class="p">():</span>
      <span class="k">print</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="o">.</span><span class="n">rawData</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-sdf-files">
<h3>Writing SDF Files<a class="headerlink" href="#writing-sdf-files" title="Permalink to this headline">¶</a></h3>
<p>It is possible to write molecules to SDF files, along with arbitrary
properties assigned.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">saver</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">mol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;C1CCC1&quot;</span><span class="p">);</span>
<span class="n">mol</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="s">&quot;cyclobutane&quot;</span><span class="p">);</span>
<span class="n">mol</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;8506&quot;</span><span class="p">);</span>
<span class="n">saver</span><span class="p">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>

<span class="n">mol</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;C(NNN)C&quot;</span><span class="p">);</span>
<span class="n">mol</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;42&quot;</span><span class="p">);</span>
<span class="n">saver</span><span class="p">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="writing-rdf-files">
<h3>Writing RDF Files<a class="headerlink" href="#writing-rdf-files" title="Permalink to this headline">¶</a></h3>
<p>Molecules and reactions can be written to an RDF file with the
<code class="docutils literal"><span class="pre">rdfAppend</span></code> method. However, the special <code class="docutils literal"><span class="pre">rdfHeader</span></code> method must be
called exactly once before anything is written into the RDF file.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">f</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s">&quot;test.rdf&quot;</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">rdfHeader</span><span class="p">();</span>
<span class="n">mol</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;WHAT&quot;</span><span class="p">,</span> <span class="s">&quot;a molecule&quot;</span><span class="p">);</span>
<span class="n">rxn</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;WHAT&quot;</span><span class="p">,</span> <span class="s">&quot;a reaction&quot;</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">rdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">rdfAppend</span><span class="p">(</span><span class="n">rxn</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="writing-cml-files">
<h3>Writing CML Files<a class="headerlink" href="#writing-cml-files" title="Permalink to this headline">¶</a></h3>
<p>Molecules can be written to a CML file with the <code class="docutils literal"><span class="pre">cmlAppend</span></code> method.
However, the <code class="docutils literal"><span class="pre">cmlHeader</span></code> method must be called exactly once before
anything is written into the CML file, and the <code class="docutils literal"><span class="pre">cmlFooter</span></code> method must
be called after all the molecules has been written.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">f</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s">&quot;structures.cml&quot;</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">cmlHeader</span><span class="p">();</span>
<span class="n">f</span><span class="p">.</span><span class="n">cmlAppend</span><span class="p">(</span><span class="n">mol1</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">cmlAppend</span><span class="p">(</span><span class="n">mol2</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">cmlFooter</span><span class="p">();</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="writing-multiline-smiles-files">
<h3>Writing Multiline SMILES Files<a class="headerlink" href="#writing-multiline-smiles-files" title="Permalink to this headline">¶</a></h3>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">f</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s">&quot;test.smi&quot;</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">smilesAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="n">f</span><span class="p">.</span><span class="n">smilesAppend</span><span class="p">(</span><span class="n">rxn</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="closing-files">
<h3>Closing Files<a class="headerlink" href="#closing-files" title="Permalink to this headline">¶</a></h3>
<p>The file output stream is closed on the object’s destructor. However,
you may need to close it explicitly. You can use the <code class="docutils literal"><span class="pre">close</span></code> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
<p>You may need to be sure that the file will be closed after some block of
code has finished executing. In Java, you can call the <code class="docutils literal"><span class="pre">close</span></code> method
in <code class="docutils literal"><span class="pre">finally</span></code> block:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">f</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
<span class="k">try</span>
<span class="p">{</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s2">&quot;test.sdf&quot;</span><span class="p">);</span>
  <span class="n">f</span><span class="o">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">finally</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C#, the “using” statement can make the job easier:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">f</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s2">&quot;test.sdf&quot;</span><span class="p">))</span>
<span class="p">{</span>
  <span class="n">f</span><span class="o">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Python, the “with” syntax serves the same purpose:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">indigo</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="s2">&quot;test.sdf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">f</span><span class="o">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generic-interface-to-writing-files">
<h3>Generic Interface to Writing Files<a class="headerlink" href="#generic-interface-to-writing-files" title="Permalink to this headline">¶</a></h3>
<p>There is also a generic interface to writing multiple
molecules/reactions in a file. You can create a generic file saver
(<code class="docutils literal"><span class="pre">IndigoObject.createFileSaver</span></code>), specifying the desired format to it,
and then append items to it (<code class="docutils literal"><span class="pre">IndigoObject.append</span></code>), not bothering
about header and footer — the saver will write them for you
automatically.</p>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.createFileSaver</span></code> method accepts the output file name
and a string with the desired format, which is “sdf”, “rdf”, “cml”, or
“smi”.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">saver</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span>
<span class="o">{</span>
  <span class="n">saver</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">createFileSaver</span><span class="o">(</span><span class="s">&quot;reactions.cml&quot;</span><span class="o">,</span> <span class="s">&quot;cml&quot;</span><span class="o">);</span>
  <span class="n">saver</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">rxn1</span><span class="o">);</span>
  <span class="n">saver</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">rxn2</span><span class="o">);</span>
<span class="o">}</span>
<span class="k">finally</span>
<span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">saver</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="n">saver</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">saver</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createFileSaver</span><span class="p">(</span><span class="s">&quot;reactions.cml&quot;</span><span class="p">,</span> <span class="s">&quot;cml&quot;</span><span class="p">))</span>
<span class="p">{</span>
   <span class="n">saver</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn1</span><span class="p">);</span>
   <span class="n">saver</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createFileSaver</span><span class="p">(</span><span class="s2">&quot;reactions.cml&quot;</span><span class="p">,</span> <span class="s2">&quot;cml&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">saver</span><span class="p">:</span>
   <span class="n">saver</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn1</span><span class="p">);</span>
   <span class="n">saver</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-into-a-memory-buffer">
<h3>Writing into a Memory Buffer<a class="headerlink" href="#writing-into-a-memory-buffer" title="Permalink to this headline">¶</a></h3>
<p>You can write the SDF or RDF data into a memory buffer instead of a
file. <code class="docutils literal"><span class="pre">Indigo.writeBuffer</span></code> method creates and returns a memory output
stream. After you have finished writing, you can call the <code class="docutils literal"><span class="pre">toString</span></code>
method to obtain the written data.</p>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">buf</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">writeBuffer</span><span class="p">();</span>
<span class="n">mol</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;cyclobutane&quot;</span><span class="p">);</span>
<span class="n">buf</span><span class="p">.</span><span class="n">sdfAppend</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="n">String</span> <span class="n">s</span> <span class="p">=</span> <span class="n">buf</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> and <code class="docutils literal"><span class="pre">String</span></code> omitted.</p>
<p>You can also create a generic saver on top of an existing buffer writer</p>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">saver</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createSaver</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&quot;cml&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="serialization">
<h3>Serialization<a class="headerlink" href="#serialization" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal"><span class="pre">IndigoObject.serialize</span></code> method to serialize a
molecule or a reaction into a binary byte array. All molecule and
reaction features are serialized, including atom coordinates,
stereochemistry, bond orientations, highlighting, AAM numbers, etc. To
restore the molecule/reaction back, use the <code class="docutils literal"><span class="pre">Indigo.unserialize</span></code>
method.</p>
<ul class="simple">
<li><strong>Note:</strong> groups are not serialized (i.e. polymer brackets and data
s-groups will be lost during serialization)</li>
<li><strong>Note:</strong> Molecule/reaction name and SDF properties ate not
serialized</li>
</ul>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="kt">byte</span><span class="p">[]</span> <span class="n">data</span> <span class="p">=</span> <span class="n">mol</span><span class="p">.</span><span class="n">serialize</span><span class="p">();</span>
<span class="p">...</span>
<span class="n">IndigoObject</span> <span class="n">mol2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">unserialize</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
</div>
<div class="section" id="match-and-similarity">
<h2>Match and Similarity<a class="headerlink" href="#match-and-similarity" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fingerprints">
<h3>Fingerprints<a class="headerlink" href="#fingerprints" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.fingerprint</span></code> method works for molecules and
reactions (including query molecules and query reactions) and returns a
<code class="docutils literal"><span class="pre">fingerprint</span></code> object. <code class="docutils literal"><span class="pre">IndigoObject.toString</span></code> and
<code class="docutils literal"><span class="pre">IndigoObject.toBuffer</span></code> methods of that object can be called to obtain
a hex-string representation or a byte array of a fingerprint,
respectively.</p>
<p>The <code class="docutils literal"><span class="pre">fingerprint</span></code> method accepts a string with a requested fingerprint
type. The following fingerprint types are available:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sim</span></code> — “Similarity fingerprint”, useful for calculating similarity
measures (the default)</li>
<li><code class="docutils literal"><span class="pre">sub</span></code> — “Substructure fingerprint”, useful for substructure
screening</li>
<li><code class="docutils literal"><span class="pre">sub-res</span></code> — “Resonance substructure fingerprint”, useful for
resonance substructure screening</li>
<li><code class="docutils literal"><span class="pre">sub-tau</span></code> — “Tautomer substructure fingerprint”, useful for
tautomer substructure screening</li>
<li><code class="docutils literal"><span class="pre">full</span></code> — “Full fingerprint”, which has all the mentioned
fingerprint types included</li>
</ul>
<p>The size of the fingerprint can be controlled via a number of
<a class="reference external" href="../options/fingerprints.html">fingerprinting options</a>.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">fp1</span> <span class="o">=</span> <span class="n">mol1</span><span class="o">.</span><span class="na">fingerprint</span><span class="o">(</span><span class="s">&quot;sim&quot;</span><span class="o">);</span>
<span class="n">fp2</span> <span class="o">=</span> <span class="n">mol2</span><span class="o">.</span><span class="na">fingerprint</span><span class="o">(</span><span class="s">&quot;sim&quot;</span><span class="o">);</span>
<span class="n">String</span> <span class="n">fp1string</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="kt">byte</span><span class="o">[]</span> <span class="n">fp2bytes</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">.</span><span class="na">toBuffer</span><span class="o">();</span>
</pre></div>
</div>
<p>Python: the same with <code class="docutils literal"><span class="pre">IndigoObject</span></code> and <code class="docutils literal"><span class="pre">String</span></code> omitted.</p>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.countBits</span></code> method calculates the number of nonzero
bits in a fingerprint. The <code class="docutils literal"><span class="pre">Indigo.commonBits</span></code> method calculates the
number of coincident nonzero bits in two fingerprints.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">bits1</span> <span class="p">=</span> <span class="n">fp1</span><span class="p">.</span><span class="n">countBits</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">bits2</span> <span class="p">=</span> <span class="n">fp2</span><span class="p">.</span><span class="n">countBits</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">bits12</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">commonBits</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">int</span></code> omitted.</p>
</div>
<div class="section" id="molecule-and-reaction-similarity">
<h3>Molecule and Reaction Similarity<a class="headerlink" href="#molecule-and-reaction-similarity" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo.similarity</span></code> method accepts two molecules, two reactions,
or two fingerprints. It also accepts a “metrics” string and returns a
float value — the similarity measure between the two given items. There
are three available metrics, which are calculated in the following way:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tanimoto</span></code> (the default) : c / (a + b - c)</li>
<li><code class="docutils literal"><span class="pre">tversky</span> <span class="pre">&lt;alpha&gt;</span> <span class="pre">&lt;beta&gt;</span></code>: c / ((a - c) * alpha + (b - c) * beta)
(if alpha and beta are omitted, they are taken for alpha = beta =
0.5)</li>
<li><code class="docutils literal"><span class="pre">euclid-sub</span></code>: c / a</li>
</ul>
<p>Where:</p>
<ul class="simple">
<li>“a” is the number of nonzero bits in the first fingerprint</li>
<li>“b” is the number of nonzero bits in the second fingerprint</li>
<li>“c” is the number of coincident bits in the two fingerprints</li>
</ul>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="kt">float</span> <span class="n">sim1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">,</span> <span class="s">&quot;tanimoto&quot;</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">sim2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">rxn1</span><span class="p">,</span> <span class="n">rxn2</span><span class="p">,</span> <span class="s">&quot;tversky&quot;</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">sim2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;tversky 0.1 0.9&quot;</span><span class="p">);</span>
<span class="kt">float</span> <span class="n">sim4</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;euclid-sub&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">float</span></code> omitted.</p>
</div>
<div class="section" id="exact-match">
<h3>Exact Match<a class="headerlink" href="#exact-match" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo.exactMatch</span></code> method accepts two molecules or reactions and
returns a “mapping” object — the result of the exact match of two given
molecules or reactions. If match is not possible, it returns <code class="docutils literal"><span class="pre">null</span></code>.
If you are interested only in does the match exist or not, you can just
check if the result of the method is <code class="docutils literal"><span class="pre">null</span></code>. Otherwise, please check
<a class="reference external" href="index.html#methods-of-mapping-object">below</a> how to work with the
mapping objects.</p>
<p><strong>Note:</strong> You can not pass query molecules or reactions to
<code class="docutils literal"><span class="pre">exactMatch</span></code>.</p>
<div class="section" id="exact-matching-flags-for-molecules">
<h4>Exact Matching Flags for Molecules<a class="headerlink" href="#exact-matching-flags-for-molecules" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">Indigo.exactMatch</span></code> method accepts an optional string. In this
string, you can pass the following flags to the matching procedure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">Comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ELE</span></code></td>
<td>Distribution of electrons: bond types, atom charges, radicals, valences</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">MAS</span></code></td>
<td>Atom isotopes</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">STE</span></code></td>
<td>Stereochemistry: chiral centers, stereogroups, and cis-trans bonds</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">FRA</span></code></td>
<td>Connected fragments: disallows match of separate ions in salts</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ALL</span></code></td>
<td>All of the above (the most permissive matching)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">TAU</span></code></td>
<td>Tautomer matching (not compatible to other flags)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NONE</span></code></td>
<td>No conditions (the most flexible kind of search)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">$number</span></code></td>
<td>Maximum allowed RMS value for affine transformation match</td>
</tr>
</tbody>
</table>
<p>The flags should go in the parameters string separated by space. Each
flag specifies a constraint for the matching procedure. The more flags
you set, the more restrictive the matching is. You can write the minus
sign before the flag to exclude it from the ‘ALL’ flag. For example,
‘ALL -MAS’ means that all the described features except the isotopes
must match.</p>
<p>The <code class="docutils literal"><span class="pre">TAU</span></code> flag stands for tautomer matching. It can not be combined
with any other flags. You can see examples of exact matching, <a class="reference external" href="../../bingo/user-manual-oracle.html#affine-transformation-search">affine
transformation
matching</a>,
and <a class="reference external" href="../../bingo/user-manual-oracle.html#exact-tautomer-search">exact tautomer
matching</a>
in the Bingo User Manual.</p>
<p><strong>Note</strong>: When no flags are specified, the behavior is equivalent to the
<code class="docutils literal"><span class="pre">ALL</span></code> flag.</p>
<p>The <code class="docutils literal"><span class="pre">$number</span></code>, if present, should go after the flags; for example:
<code class="docutils literal"><span class="pre">ALL</span> <span class="pre">0.1</span></code>. The given <code class="docutils literal"><span class="pre">number</span></code> is the maximum allowed
root-mean-square deviation between the atoms of the two molecules,
measured in angstroms. Prior to the calculation of the RMS value, the
optimal affine transformation (translation+rotation+scale) is applied to
one of the molecules to make it as close as possible to the other
molecule.</p>
<p><strong>Note</strong>: Affine transformation matching is not possible when the
molecule’s atoms do not have coordinates (e.g. the molecule was loaded
from SMILES).</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;ALL 0.1&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="c1">// affine matching has failed?</span>
   <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="c1">// exact match has failed, trying to ignore stereochemistry</span>
   <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;ALL -STE&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="c1">// failed again; trying the most permissive matching</span>
   <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;NONE&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s2">&quot;ALL 0.1&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
   <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">)</span> <span class="c1"># equivalent to ALL</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
   <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s2">&quot;ALL -STE&quot;</span><span class="p">)</span> <span class="c1"># equivalent to &quot;ELE MAS FRA&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
   <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="s2">&quot;NONE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="exact-matching-flags-for-reactions">
<h4>Exact Matching Flags for Reactions<a class="headerlink" href="#exact-matching-flags-for-reactions" title="Permalink to this headline">¶</a></h4>
<p>When calling the <code class="docutils literal"><span class="pre">Indigo.exactMatch</span></code> method for reactions, you can
pass it the “ELE”, “MAS”, and “STE” flags, which have the same meaning
as in molecule exact matching. You can also pass two reaction-specific
flags:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">Comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">AAM</span></code></td>
<td>Atom-atom mapping</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">RCT</span></code></td>
<td>Reacting centers</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> <code class="docutils literal"><span class="pre">FRA</span></code>, <code class="docutils literal"><span class="pre">TAU</span></code>, and affine matching are not available for
reactions.</p>
</div>
</div>
<div class="section" id="molecule-substructure-matching">
<h3>Molecule Substructure Matching<a class="headerlink" href="#molecule-substructure-matching" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo.substructureMatcher</span></code> method accepts a molecule (but not a
query molecule) and returns a “substructure matcher” object. The given
molecule is going to be the “target” molecule for the substructure
match.</p>
<div class="section" id="molecule-substructure-matching-flags">
<h4>Molecule Substructure Matching Flags<a class="headerlink" href="#molecule-substructure-matching-flags" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">Indigo.substructureMatcher</span></code> method accepts an optional string, in
which you can specify one of the following flags:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">RES</span></code> — chemical resonance matching mode (<code class="docutils literal"><span class="pre">C=N</span></code>
matches <code class="docutils literal"><span class="pre">CN=O</span></code> etc). You can read more about the resonance search
and see examples on the <a class="reference external" href="../../bingo/user-manual-oracle.html#resonance-search">Bingo User
Manual</a>
page.</li>
<li><code class="docutils literal"><span class="pre">TAU</span></code> — tautomer matching mode. You can read more
about the tautomer substructure search and see examples on the <a class="reference external" href="../../bingo/user-manual-oracle.html#tautomer-substructure-search">Bingo
User
Manual</a>
page.</li>
<li><code class="docutils literal"><span class="pre">TAU</span> <span class="pre">INCHI</span></code> — tautomer matching mode based on <a class="reference external" href="../../resources.html#inchi-code">InChI code</a>. Read more
about the tautomer substructure search and see examples on the <a class="reference external" href="../../bingo/user-manual-oracle.html#tautomer-substructure-search-based-on-inchi-or-reaction-smarts">Bingo User Manual</a>
page.</li>
<li><code class="docutils literal"><span class="pre">TAU</span> <span class="pre">RSMARTS</span></code> — tautomer matching mode based on <a class="reference external" href="../../resources.html#rsmarts-rules">RSMARTS rules</a>. Read more
about the tautomer substructure search and see examples on the <a class="reference external" href="../../bingo/user-manual-oracle.html#tautomer-substructure-search-based-on-inchi-or-reaction-smarts">Bingo User Manual</a>
page.</li>
</ul>
</div>
<div class="section" id="methods-of-substructure-matcher">
<h4>Methods of Substructure Matcher<a class="headerlink" href="#methods-of-substructure-matcher" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IndigoObject.ignoreAtom</span></code> method accepts an atom of the target
molecule and marks it as “ignored” for the substructure matcher. No
atom of any query will be mapped to this atom.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.unignoreAtom</span></code> method cancels the effect of the
<code class="docutils literal"><span class="pre">ignoreAtom</span></code> method for the given atom.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.unignoreAllAtoms</span></code> method cancels the effect of
previous <code class="docutils literal"><span class="pre">ignoreAtom</span></code> calls.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.match</span></code> accepts a query molecule and returns a
“mapping” object if the matching has succeeded. If multiple matches
are possible, the first one is taken. If no match is possible, it
returns <code class="docutils literal"><span class="pre">null</span></code>.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countMatches</span></code> accepts a query molecule and returns
the number or unique matches.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.countMatchesWithLimit</span></code> works like <code class="docutils literal"><span class="pre">countMatches</span></code>,
but also accepts an additional integer parameter for limiting the
number of matches.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.iterateMatches</span></code> accepts a query molecule and returns
an iterator for unique matches (“mapping” objects).</li>
</ul>
<p>Also, please take a look on some
<a class="reference external" href="../options/substructure-matching-options.html">options</a> available for
substructure matchers.</p>
</div>
</div>
<div class="section" id="reaction-substructure-matching">
<h3>Reaction Substructure Matching<a class="headerlink" href="#reaction-substructure-matching" title="Permalink to this headline">¶</a></h3>
<p>You can pass a reaction to the <code class="docutils literal"><span class="pre">Indigo.substructureMatcher</span></code> method to
obtain a “reaction substructure matcher” object. It responds to the
<code class="docutils literal"><span class="pre">IndigoObject.match</span></code> method similarly to the molecule matcher. This
method returns a “reaction match” object, or <code class="docutils literal"><span class="pre">null</span></code> if the matching is
not possible.</p>
<p>You can specify optional <code class="docutils literal"><span class="pre">DAYLIGHT-AAM</span></code> flag to the matcher. When this
flag is present, the matching of the atom-atom mapping (reaction AAM) is
following the Daylight’s rules for <a class="reference external" href="http://www.daylight.com/dayhtml/doc/theory/theory.smarts.html">reaction
SMARTS</a>.
Otherwise, it follows ordinary rules that are normal for matching
Rxnfiles.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">rxn1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReactionSmarts</span><span class="p">(</span><span class="s">&quot;[C:1][C:1]&gt;&gt;[C:1]&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">rxn2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadReaction</span><span class="p">(</span><span class="s">&quot;[CH3:7][CH3:8]&gt;&gt;[CH3:7][CH3:8]&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">rxn2</span><span class="p">,</span> <span class="s">&quot;DAYLIGHT-AAM&quot;</span><span class="p">).</span><span class="n">match</span><span class="p">(</span><span class="n">rxn1</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
<p><strong>Note:</strong> <code class="docutils literal"><span class="pre">ignoreAtom</span></code>, <code class="docutils literal"><span class="pre">unignoreAtoms</span></code>, <code class="docutils literal"><span class="pre">unignoreAllAtoms</span></code>,
<code class="docutils literal"><span class="pre">countMatches</span></code>, <code class="docutils literal"><span class="pre">countMatchesWithLimit</span></code>, and <code class="docutils literal"><span class="pre">iterateMatches</span></code>
methods are not supported by reaction substructure matcher.</p>
</div>
<div class="section" id="converting-the-substructure-query-to-the-aromatic-form">
<h3>Converting the Substructure Query to the Aromatic Form<a class="headerlink" href="#converting-the-substructure-query-to-the-aromatic-form" title="Permalink to this headline">¶</a></h3>
<p>If your query is loaded from a Molfile or SMILES and its aromatic rings
are represented in Kekule form, you should transform it to aromatic form
prior to matching. Otherwise, it will not match the aromatic rings in
the target structure.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">query</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMoleculeFromFile</span><span class="p">(</span><span class="s">&quot;kekule.mol&quot;</span><span class="p">);</span>
<span class="n">query</span><span class="p">.</span><span class="n">aromatize</span><span class="p">();</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
<p><strong>Note:</strong> <code class="docutils literal"><span class="pre">aromatize</span></code> does not have any effect for SMARTS queries (and
should not be called on them).</p>
</div>
<div class="section" id="optimizing-the-substructure-query">
<h3>Optimizing the Substructure Query<a class="headerlink" href="#optimizing-the-substructure-query" title="Permalink to this headline">¶</a></h3>
<p>If you have a complex molecule or reaction SMARTS query, you can
“optimize” it in-memory so that the matching performs faster.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">query</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s">&quot;[$([a;r4,!R1&amp;r3])]1:[$([a;r4,!R1&amp;r3])]:[$([a;r4,!R1&amp;r3])]:[$([a;r4,!R1&amp;r3])]:1&quot;</span><span class="p">);</span>
<span class="n">query</span><span class="p">.</span><span class="n">optimize</span><span class="p">();</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted.</p>
</div>
<div class="section" id="methods-of-mapping-object">
<h3>Methods of “mapping” object<a class="headerlink" href="#methods-of-mapping-object" title="Permalink to this headline">¶</a></h3>
<p>You can get the detailed information about the succeeded matching via
the returned “mapping” <code class="docutils literal"><span class="pre">IndigoObject</span></code>. It responds to the following
method calls:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IndigoObject.mapAtom</span></code> method accepts an atom of the query
molecule/reaction and returns the corresponding atom from the target
molecule/reaction. In case the query atom is unmapped (this can
happen only with explicit hydrogens), it returns <code class="docutils literal"><span class="pre">null</span></code>. You can
use <code class="docutils literal"><span class="pre">IndigoObject.index</span></code> method to get mapped atom index.</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.mapBond</span></code> method is similar to <code class="docutils literal"><span class="pre">mapAtom</span></code>, but
accepts a bond of the query and returns a bond of the target. It can
also return <code class="docutils literal"><span class="pre">null</span></code> if the bond is unmapped (this can happen only
with bonds to explicit hydrogens).</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.mapMolecule</span></code> method is similar to <code class="docutils literal"><span class="pre">mapAtom</span></code>, but
accepts a molecule of the query reaction and returns a molecule of
the target reaction. It can also return <code class="docutils literal"><span class="pre">null</span></code> if the molecule is
unmapped (this can happen if a molecule within a query reaction
represents explicit hydrogen).</li>
<li><code class="docutils literal"><span class="pre">IndigoObject.highlightedTarget</span></code> method returns a copy of the
target molecule/reaction where the matched atoms and bonds are
highlighted.</li>
</ul>
<p><strong>Note:</strong> The <code class="docutils literal"><span class="pre">IndigoObject.mapAtom</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.ignoreAtom</span></code>
methods accepts only atoms, and not atom indices. Similarly, the
<code class="docutils literal"><span class="pre">IndigoObject.mapBond</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.mapMolecule</span></code> method accepts
only bonds and molecules respectively, and not their indices.</p>
<div class="section" id="example-1-mapping-query-molecule-atoms">
<h4>Example 1 (mapping query molecule atoms)<a class="headerlink" href="#example-1-mapping-query-molecule-atoms" title="Permalink to this headline">¶</a></h4>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">substructureMatcher</span><span class="o">(</span><span class="n">mol</span><span class="o">).</span><span class="na">match</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">match</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
<span class="o">{</span>
   <span class="n">match</span><span class="o">.</span><span class="na">highlightedTarget</span><span class="o">().</span><span class="na">saveMolfile</span><span class="o">(</span><span class="s">&quot;highlighted.mol&quot;</span><span class="o">);</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">qmol2</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;atom %d mapped to atom %d\n&quot;</span><span class="o">,</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">(),</span> <span class="n">match</span><span class="o">.</span><span class="na">mapAtom</span><span class="o">(</span><span class="n">atom</span><span class="o">).</span><span class="na">index</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">).</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">match</span><span class="p">.</span><span class="n">highlightedTarget</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;highlighted.mol&quot;</span><span class="p">);</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">qmol2</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;atom {0} mapped to atom {1}&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">match</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">).</span><span class="n">index</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
   <span class="n">match</span><span class="o">.</span><span class="n">highlightedTarget</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;highlighted.mol&quot;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">qmol2</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
      <span class="k">print</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;mapped to atom&quot;</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-getting-the-highlighted-target-molecule">
<h4>Example 2 (getting the highlighted target molecule)<a class="headerlink" href="#example-2-getting-the-highlighted-target-molecule" title="Permalink to this headline">¶</a></h4>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">substructureMatcher</span><span class="o">(</span><span class="n">mol</span><span class="o">);</span>
<span class="n">IndigoObject</span> <span class="n">query</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadSmarts</span><span class="o">(</span><span class="s">&quot;O=[!C;R]&quot;</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">countMatches</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">:</span> <span class="n">matcher</span><span class="o">.</span><span class="na">iterateMatches</span><span class="o">(</span><span class="n">query</span><span class="o">))</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">match</span><span class="o">.</span><span class="na">highlightedTarget</span><span class="o">().</span><span class="na">smiles</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">matcher</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">query</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s">&quot;O=[!C;R]&quot;</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">matcher</span><span class="p">.</span><span class="n">countMatches</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="k">in</span> <span class="n">matcher</span><span class="p">.</span><span class="n">iterateMatches</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">highlightedTarget</span><span class="p">().</span><span class="n">smiles</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">matcher</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadSmarts</span><span class="p">(</span><span class="s2">&quot;O=[!C;R]&quot;</span><span class="p">)</span>

<span class="k">print</span> <span class="n">matcher</span><span class="o">.</span><span class="n">countMatches</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matcher</span><span class="o">.</span><span class="n">iterateMatches</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
   <span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">highlightedTarget</span><span class="p">()</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-exact-match-between-reactions">
<h4>Example 3 (exact match between reactions)<a class="headerlink" href="#example-3-exact-match-between-reactions" title="Permalink to this headline">¶</a></h4>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">exactMatch</span><span class="o">(</span><span class="n">rxn1</span><span class="o">,</span> <span class="n">rxn2</span><span class="o">,</span> <span class="s">&quot;ALL -AAM&quot;</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">match</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
<span class="o">{</span>
   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="o">:</span> <span class="n">rxn1</span><span class="o">.</span><span class="na">iterateMolecules</span><span class="o">())</span>
   <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;molecule #&quot;</span> <span class="o">+</span> <span class="n">mol</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>

      <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">match</span><span class="o">.</span><span class="na">mapAtom</span><span class="o">(</span><span class="n">atom</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
           <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;atom #%d matched\n&quot;</span><span class="o">,</span> <span class="n">atom</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>

      <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="o">:</span> <span class="n">mol</span><span class="o">.</span><span class="na">iterateBonds</span><span class="o">())</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">match</span><span class="o">.</span><span class="na">mapBond</span><span class="o">(</span><span class="n">atom</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
           <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;bond #%d matched\n&quot;</span><span class="o">,</span> <span class="n">bond</span><span class="o">.</span><span class="na">index</span><span class="o">());</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">rxn1</span><span class="p">,</span> <span class="n">rxn2</span><span class="p">,</span> <span class="s">&quot;ALL -AAM&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">match</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">mol</span> <span class="k">in</span> <span class="n">rxn1</span><span class="p">.</span><span class="n">iterateMolecules</span><span class="p">())</span>
   <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">writeLine</span><span class="p">(</span><span class="s">&quot;molecule #&quot;</span> <span class="p">+</span> <span class="n">mol</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>

      <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">atom</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
           <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;atom #{0} matched\n&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>

      <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="k">in</span> <span class="n">mol</span><span class="p">.</span><span class="n">iterateBonds</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">mapBond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
           <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;bond #{0} matched\n&quot;</span><span class="p">,</span> <span class="n">bond</span><span class="p">.</span><span class="n">index</span><span class="p">());</span>

   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">exactMatch</span><span class="p">(</span><span class="n">rxn1</span><span class="p">,</span> <span class="n">rxn2</span><span class="p">,</span> <span class="s2">&quot;ALL -AAM&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
  <span class="n">foreach</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">rxn1</span><span class="o">.</span><span class="n">iterateMolecules</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;molecule #&quot;</span> <span class="o">+</span> <span class="n">mol</span><span class="o">.</span><span class="n">index</span><span class="p">();</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">atom</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;atom #&quot;</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;matched&quot;</span>

    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">mapBond</span><span class="p">(</span><span class="n">bond</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;bond #&quot;</span><span class="p">,</span> <span class="n">bond</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="s2">&quot;matched&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tautomer-matching-rules">
<h3>Tautomer Matching Rules<a class="headerlink" href="#tautomer-matching-rules" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>By default, any chains that satisfy basic conditions of tautomerism,
are considered tautomeric by he tautomer matcher. You can restrict
the tautomer matching by enabling conditions for boundary atoms in
tautomeric chains. Each rule consists of two conditions, for two
boundary atoms of the chain. The rules are numbered (1,2,…), and
the numbers can be used in matcher’s parameter string after the
<code class="docutils literal"><span class="pre">TAU</span></code> specifier (<code class="docutils literal"><span class="pre">TAU</span> <span class="pre">R1</span> <span class="pre">R2</span></code>). The more rules you specify, the
more flexibility you receive in the search; <em>but</em> when you specify no
rules at all (<code class="docutils literal"><span class="pre">TAU</span></code>), you get the most flexible search because no
rules are checked. Any tautomeric chain is acceptable in this case.
You can also use <code class="docutils literal"><span class="pre">TAU</span> <span class="pre">R*</span></code> to specify all rules at once.</li>
<li>Some metal bonds and atom charges can replace hydrogen in tautomeric
chains. You can add the HYD word to disable such hydrogen
replacements (<code class="docutils literal"><span class="pre">TAU</span> <span class="pre">HYD</span></code>).</li>
<li>Ring-chain tautomerism is disabled by default. You can add <code class="docutils literal"><span class="pre">R-C</span></code> to
enable it (<code class="docutils literal"><span class="pre">TAU</span> <span class="pre">R-C</span></code>).</li>
</ul>
<p>The following three rules are recommended and are used in examples:</p>
<ul class="simple">
<li>Each boundary atom in the tautomeric chain must be one of N, O, P, S,
As, Se, Sb, Te</li>
<li>Carbon not from the aromatic ring at one end of the tautomeric chain,
and one of N, O, P, S at the other end</li>
<li>Carbon from the aromatic ring at one end of the tautomeric chain and
one of N, O at the other end</li>
</ul>
<div class="section" id="customizing-the-rules">
<h4>Customizing the rules<a class="headerlink" href="#customizing-the-rules" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">Indigo</span></code> provides thee methods to customize the rules:
<code class="docutils literal"><span class="pre">clearTautomerRules</span></code>, <code class="docutils literal"><span class="pre">setTautomerRule</span></code>, and <code class="docutils literal"><span class="pre">removeTautomerRule</span></code>.
There are no rules by default. The <code class="docutils literal"><span class="pre">Indigo.setTautomerRule</span></code> method
accepts an ID number of the rule (must be from 1 to 32), and two strings
(for two bound atoms of the chain), containing allowed elements are
separated by commas. ‘1’ at the beginning means an aromatic atom, and
‘0’ means an aliphatic (non-aromatic) atom.</p>
<p>The three rules defined above can be set in the following way:</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="p">.</span><span class="n">setTautomerRule</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">&quot;N,O,P,S,As,Se,Sb,Te&quot;</span><span class="p">,</span> <span class="s">&quot;N,O,P,S,As,Se,Sb,Te&quot;</span><span class="p">);</span>
<span class="n">indigo</span><span class="p">.</span><span class="n">setTautomerRule</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="s">&quot;0C&quot;</span><span class="p">,</span> <span class="s">&quot;N,O,P,S&quot;</span><span class="p">);</span>
<span class="n">indigo</span><span class="p">.</span><span class="n">setTautomerRule</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="s">&quot;1C&quot;</span><span class="p">,</span> <span class="s">&quot;N,O&quot;</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">mol1</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadQueryMolecule</span><span class="p">(</span><span class="s">&quot;OC1=CC=CNC1&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">mol2</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s">&quot;O=C1CNCC2=CC=CC=C12&quot;</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">matcher</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">mol2</span><span class="p">,</span> <span class="s">&quot;TAU R2&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">matcher</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="n">mol1</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with <code class="docutils literal"><span class="pre">IndigoObject</span></code> omitted</p>
</div>
</div>
<div class="section" id="highlighting-atoms-and-bonds">
<h3>Highlighting Atoms and Bonds<a class="headerlink" href="#highlighting-atoms-and-bonds" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.highlight</span></code> and <code class="docutils literal"><span class="pre">IndigoObject.unhighlight</span></code> methods
can be applied to an atom or a bond. Also, the
<code class="docutils literal"><span class="pre">IndigoObject.unhighlight</span></code> method can be applied to a molecule or
reaction to dismiss the highlighting on the whole molecule or reaction.
You can check if object is highlighted using
<code class="docutils literal"><span class="pre">IndigoObject.isHighlighted</span></code> method.</p>
<p>The following example shows how to highlight the matched atoms and bonds
on a substructure matcher’s target, along with explicit hydrogens
attached to the matched atoms.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">substructureMatcher</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
<span class="n">IndigoObject</span> <span class="n">match</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="na">match</span><span class="o">(</span><span class="n">query</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">query</span><span class="o">.</span><span class="na">iterateAtoms</span><span class="o">())</span>
<span class="o">{</span>
   <span class="n">IndigoObject</span> <span class="n">atom</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="na">mapAtom</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
   <span class="n">atom</span><span class="o">.</span><span class="na">highlight</span><span class="o">();</span>

   <span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">nei</span> <span class="o">:</span> <span class="n">atom</span><span class="o">.</span><span class="na">iterateNeighbors</span><span class="o">())</span>
   <span class="o">{</span>
      <span class="k">if</span> <span class="o">(!</span><span class="n">nei</span><span class="o">.</span><span class="na">isPseudoatom</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">nei</span><span class="o">.</span><span class="na">isRSite</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">nei</span><span class="o">.</span><span class="na">atomicNumber</span><span class="o">()</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
      <span class="o">{</span>
         <span class="n">nei</span><span class="o">.</span><span class="na">highlight</span><span class="o">();</span>
         <span class="n">nei</span><span class="o">.</span><span class="na">bond</span><span class="o">().</span><span class="na">highlight</span><span class="o">();</span>
      <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="o">:</span> <span class="n">query</span><span class="o">.</span><span class="na">iterateBonds</span><span class="o">())</span>
   <span class="n">match</span><span class="o">.</span><span class="na">mapBond</span><span class="o">(</span><span class="n">bond</span><span class="o">).</span><span class="na">highlight</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">target</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
<span class="n">target</span><span class="o">.</span><span class="na">unhighlight</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">target</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">matcher</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">target</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">match</span> <span class="p">=</span> <span class="n">matcher</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">qatom</span> <span class="k">in</span> <span class="n">query</span><span class="p">.</span><span class="n">iterateAtoms</span><span class="p">())</span>
<span class="p">{</span>
   <span class="n">IndigoObject</span> <span class="n">atom</span> <span class="p">=</span> <span class="n">match</span><span class="p">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">qatom</span><span class="p">);</span>
   <span class="n">atom</span><span class="p">.</span><span class="n">highlight</span><span class="p">();</span>

   <span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">nei</span> <span class="k">in</span> <span class="n">atom</span><span class="p">.</span><span class="n">iterateNeighbors</span><span class="p">())</span>
   <span class="p">{</span>
      <span class="k">if</span> <span class="p">(!</span><span class="n">nei</span><span class="p">.</span><span class="n">isPseudoatom</span><span class="p">()</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">nei</span><span class="p">.</span><span class="n">isRSite</span><span class="p">()</span> <span class="p">&amp;&amp;</span> <span class="n">nei</span><span class="p">.</span><span class="n">atomicNumber</span><span class="p">()</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
      <span class="p">{</span>
         <span class="n">nei</span><span class="p">.</span><span class="n">highlight</span><span class="p">();</span>
         <span class="n">nei</span><span class="p">.</span><span class="n">bond</span><span class="p">().</span><span class="n">highlight</span><span class="p">();</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">bond</span> <span class="k">in</span> <span class="n">query</span><span class="p">.</span><span class="n">iterateBonds</span><span class="p">())</span>
   <span class="n">match</span><span class="p">.</span><span class="n">mapBond</span><span class="p">(</span><span class="n">bond</span><span class="p">).</span><span class="n">highlight</span><span class="p">();</span>

<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
<span class="n">target</span><span class="p">.</span><span class="n">unhighlight</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">matcher</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">substructureMatcher</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="k">for</span> <span class="n">qatom</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">iterateAtoms</span><span class="p">():</span>
  <span class="n">atom</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">mapAtom</span><span class="p">(</span><span class="n">qatom</span><span class="p">)</span>
  <span class="n">atom</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">nei</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">iterateNeighbors</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">nei</span><span class="o">.</span><span class="n">isPseudoatom</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nei</span><span class="o">.</span><span class="n">isRSite</span><span class="p">()</span> <span class="ow">and</span> <span class="n">nei</span><span class="o">.</span><span class="n">atomicNumber</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">nei</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>
      <span class="n">nei</span><span class="o">.</span><span class="n">bond</span><span class="p">()</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>

<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">iterateBonds</span><span class="p">():</span>
  <span class="n">match</span><span class="o">.</span><span class="n">mapBond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>

<span class="k">print</span> <span class="n">target</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
<span class="n">target</span><span class="o">.</span><span class="n">unhighlight</span><span class="p">()</span>
<span class="k">print</span> <span class="n">target</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rendering">
<h2>Rendering<a class="headerlink" href="#rendering" title="Permalink to this headline">¶</a></h2>
<p>Rendering in Indigo is done by the <code class="docutils literal"><span class="pre">IndigoRenderer</span></code> plugin which is
included in the Indigo distribution. The plugin is available for C (as a
separate dynamic library), and has wrappers for all supported languages.</p>
<p>To work with the rendering plugin in C#/Java/Python wrappers, one needs
to create an instance of <code class="docutils literal"><span class="pre">IndigoRenderer</span></code>, passing an existing
<code class="docutils literal"><span class="pre">Indigo</span></code> instance to it.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoRenderer</span> <span class="n">renderer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">IndigoRenderer</span><span class="p">(</span><span class="n">indigo</span><span class="p">);</span>
</pre></div>
</div>
<p>A large number of <a class="reference external" href="../options/rendering-options.html">options</a> can be set for
the rendering plugin. They are set via the ordinary <code class="docutils literal"><span class="pre">Indigo</span></code> instance.
One of the options is obligatory: <code class="docutils literal"><span class="pre">render-output-format</span></code> tells which
format the image should be rendered to.</p>
<p>The <code class="docutils literal"><span class="pre">IndigoRenderer.renderToBuffer</span></code> accepts an <code class="docutils literal"><span class="pre">IndigoObject</span></code> and
returns a byte buffer with PNG, SVG, or PDF image (on the Windows
platform, EMF format is supported too). Similarly, the
<code class="docutils literal"><span class="pre">IndigoRenderer.renderToFile</span></code> method saves the image to a file.</p>
<p>Java and C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">indigo</span><span class="p">.</span><span class="n">setOption</span><span class="p">(</span><span class="s">&quot;render-output-format&quot;</span><span class="p">,</span> <span class="s">&quot;png&quot;</span><span class="p">);</span>
<span class="n">indigo</span><span class="p">.</span><span class="n">setOption</span><span class="p">(</span><span class="s">&quot;render-margins&quot;</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">);</span>
<span class="n">mol1</span><span class="p">.</span><span class="n">layout</span><span class="p">();</span>
<span class="n">indigo</span><span class="p">.</span><span class="n">setOption</span><span class="p">(</span><span class="s">&quot;render-comment&quot;</span><span class="p">,</span> <span class="s">&quot;N-Hydroxyaniline&quot;</span><span class="p">)</span>
<span class="n">renderer</span><span class="p">.</span><span class="n">renderToFile</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="s">&quot;mol.png&quot;</span><span class="p">);</span>

<span class="n">indigo</span><span class="p">.</span><span class="n">setOption</span><span class="p">(</span><span class="s">&quot;render-output-format&quot;</span><span class="p">,</span> <span class="s">&quot;svg&quot;</span><span class="p">);</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">svg</span> <span class="p">=</span> <span class="n">renderer</span><span class="p">.</span><span class="n">renderToBuffer</span><span class="p">(</span><span class="n">rxn</span><span class="p">);</span>
</pre></div>
</div>
<p>Python: the same with the <code class="docutils literal"><span class="pre">byte[]</span></code> omitted.</p>
<div class="section" id="rendering-multiple-items-to-grid">
<h3>Rendering Multiple Items to Grid<a class="headerlink" href="#rendering-multiple-items-to-grid" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">IndigoRenderer.renderGridToFile</span></code> and
<code class="docutils literal"><span class="pre">IndigoRenderer.renderGridToBuffer</span></code> methods can be used to render
multiple molecules or reactions at once. The rendered items are placed
in grid specified by its number of columns. Some
<a class="reference external" href="../options/rendering-options.html">options</a> are available for placing
titles under (or above) the items.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">createArray</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateSDFile</span><span class="o">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="o">))</span>
   <span class="n">arr</span><span class="o">.</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>

<span class="n">renderer</span><span class="o">.</span><span class="na">renderGridToFile</span><span class="o">(</span><span class="n">collection</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="s">&quot;structures.png&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">arr</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createArray</span><span class="p">();</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">))</span>
   <span class="n">arr</span><span class="p">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="n">renderer</span><span class="p">.</span><span class="n">renderGridToFile</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="s">&quot;structures.png&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">();</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s2">&quot;structures.sdf&quot;</span><span class="p">):</span>
   <span class="n">arr</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="n">renderer</span><span class="o">.</span><span class="n">renderGridToFile</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;structures.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second parameter of the <code class="docutils literal"><span class="pre">IndigoRenderer.renderGridToFile</span></code> and
<code class="docutils literal"><span class="pre">IndigoRenderer.renderGridToBuffer</span></code> methods is optional. You can
specify it only for molecules, not for reactions. If this parameter is
not <code class="docutils literal"><span class="pre">null</span></code>, it has to be an integer array whose number of elements is
equal to the number of given molecules. Each element of this array is
the index of the “reference atom” in the corresponding molecule. The
rendering is then done in such a way that the reference atoms are
grid-aligned. You can see the examples of this at
<a class="reference external" href="http://ctr.wikia.com/wiki/Align_the_depiction_using_a_fixed_substructure">CTR</a>.</p>
</div>
<div class="section" id="win32-and-net-support">
<h3>Win32 and .NET Support<a class="headerlink" href="#win32-and-net-support" title="Permalink to this headline">¶</a></h3>
<p>In the .NET API, additional <code class="docutils literal"><span class="pre">IndigoRenderer</span></code> methods are available for
working with Win32 HDC and <code class="docutils literal"><span class="pre">System.Drawing</span></code> objects directly:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">void</span> <span class="pre">renderToHDC</span> <span class="pre">(IndigoObject</span> <span class="pre">item,</span> <span class="pre">IntPtr</span> <span class="pre">hdc,</span> <span class="pre">bool</span> <span class="pre">printing)</span></code></li>
<li><code class="docutils literal"><span class="pre">Bitmap</span> <span class="pre">renderToBitmap</span> <span class="pre">(IndigoObject</span> <span class="pre">item)</span></code></li>
<li><code class="docutils literal"><span class="pre">Metafile</span> <span class="pre">renderToMetafile</span> <span class="pre">(IndigoObject</span> <span class="pre">item)</span></code></li>
</ul>
</div>
</div>
<div class="section" id="scaffold-detection-and-r-group-decomposition">
<h2>Scaffold Detection and R-Group Decomposition<a class="headerlink" href="#scaffold-detection-and-r-group-decomposition" title="Permalink to this headline">¶</a></h2>
<div class="section" id="scaffold-detection">
<h3>Scaffold Detection<a class="headerlink" href="#scaffold-detection" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Indigo.extractCommonScaffold(mode</span> <span class="pre">[max_iterations])</span></code> method
searches MCS scaffold for given molecules array and returns an
extraction result. The method accepts a string parameter called
<code class="docutils literal"><span class="pre">mode</span></code>. The following modes are available:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">exact</span></code> : searches MCS using the exact algorithm.</li>
<li><code class="docutils literal"><span class="pre">approx</span></code> : searches MCS using the approximate algorithm</li>
</ul>
<p>There is an optional integer parameter (iteration limit) followed by the
mode. The default value for the exact algorithm is 0 (infinite) and for
the approximate algorithm is 1000.</p>
<p>Indigo searches MCS in terms of a largest induced molecule1 subgraph
isomorphic to an induced molecule2 subgraph. Largest means that a result
subgraph can not be extended by the adding a vertex (atom). E.g. there
are three possible mcs for the molecules ‘NCOCCCS’ and ‘NCCOCCS’ which
can not be extended: ‘CCOC’, ‘NC’ and ‘CCS’. Indigo stores all the
intermediate subgraphs, which can be a result MCS. Thus, after a
searching is finished, there is an array (all the solutions) of
submolecules available. In the end, the result molecules array is sorted
by the following rule: maximize rings number; if two molecules contain
equal ring number, then maximize bonds number. The result sorted
molecules array (all the maximum common submolecules) can be iterated by
the <code class="docutils literal"><span class="pre">allScaffolds()</span></code> method. The <code class="docutils literal"><span class="pre">IndigoObject.allScaffolds()</span></code>
method returns an array object.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">createArray</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">indigo</span><span class="o">.</span><span class="na">iterateSDFile</span><span class="o">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="o">))</span>
   <span class="n">arr</span><span class="o">.</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>

<span class="n">IndigoObject</span> <span class="n">scaf</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">extractCommonScaffold</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="s">&quot;exact&quot;</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">scaf</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;max scaffold: &quot;</span> <span class="o">+</span> <span class="n">scaf</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
  <span class="k">for</span><span class="o">(</span><span class="n">IndigoObject</span> <span class="n">scaffold</span><span class="o">:</span> <span class="n">scaf</span><span class="o">.</span><span class="na">allScaffolds</span><span class="o">().</span><span class="na">iterateArray</span><span class="o">())</span>
     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;current scaffold: &quot;</span> <span class="o">+</span> <span class="n">scaffold</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">arr</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createArray</span><span class="p">();</span>

<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">indigo</span><span class="p">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s">&quot;structures.sdf&quot;</span><span class="p">))</span>
   <span class="n">arr</span><span class="p">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">scaf</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">extractCommonScaffold</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s">&quot;approx 2000&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">scaf</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;max scaffold: &quot;</span> <span class="p">+</span> <span class="n">scaf</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
  <span class="k">for</span><span class="p">(</span><span class="n">IndigoObject</span> <span class="n">scaffold</span><span class="p">:</span> <span class="n">scaf</span><span class="p">.</span><span class="n">allScaffolds</span><span class="p">().</span><span class="n">iterateArray</span><span class="p">())</span>
     <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;current scaffold: &quot;</span> <span class="p">+</span> <span class="n">scaffold</span><span class="p">.</span><span class="n">smiles</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">();</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">indigo</span><span class="o">.</span><span class="n">iterateSDFile</span><span class="p">(</span><span class="s2">&quot;structures.sdf&quot;</span><span class="p">):</span>
   <span class="n">arr</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="n">scaf</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">extractCommonScaffold</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s2">&quot;exact 1000&quot;</span><span class="p">);</span>

<span class="k">if</span> <span class="n">scaf</span><span class="p">:</span>
  <span class="k">print</span> <span class="s2">&quot;max scaffold:&quot;</span> <span class="o">+</span> <span class="n">scaf</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">scaffold</span> <span class="ow">in</span> <span class="n">scaf</span><span class="o">.</span><span class="n">allScaffolds</span><span class="p">()</span><span class="o">.</span><span class="n">iterateArray</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;current scaffold:&quot;</span> <span class="o">+</span> <span class="n">scaffold</span><span class="o">.</span><span class="n">smiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="r-group-decomposition">
<h3>R-Group Decomposition<a class="headerlink" href="#r-group-decomposition" title="Permalink to this headline">¶</a></h3>
<p>The R-Group decomposition algorithm separates given molecule into a
scaffold (matches the given query molecule) and R-Groups. To start
working with the algorithm you need to create a <code class="docutils literal"><span class="pre">Decomposer</span></code> object.
The <code class="docutils literal"><span class="pre">Indigo.createDecomposer</span></code> method accepts a query molecule and
returns the <code class="docutils literal"><span class="pre">Decomposer</span></code> object. During a decomposition the
<code class="docutils literal"><span class="pre">Decomposer</span></code> object builds a common scaffold with all R-Groups
gathered together(so named <code class="docutils literal"><span class="pre">full</span> <span class="pre">scaffold</span></code>). The scaffold matches
every passed molecule and together with calculated R-Groups restores
initial molecules. Once the <code class="docutils literal"><span class="pre">Decomposer</span></code> object is created, you can
pass molecules into and perform the decomposition. The method
<code class="docutils literal"><span class="pre">IndigoObject.decomposeMolecule</span></code> returns a <code class="docutils literal"><span class="pre">DecompositionItem</span></code>
object. The method accepts molecule. User can get the calculated results
by accessing the <code class="docutils literal"><span class="pre">DecompositionItem</span></code> object. The following methods are
used to get the results:</p>
<p>The <code class="docutils literal"><span class="pre">IndigoObject.decomposedMoleculeWithRGroups</span></code> returns molecule
separated into a scaffold with R-Groups (<code class="docutils literal"><span class="pre">DecompositionItem</span></code> object).
The <code class="docutils literal"><span class="pre">IndigoObject.decomposedMoleculeHighlighte</span></code> returns molecule with
a highlighted scaffold (<code class="docutils literal"><span class="pre">DecompositionItem</span></code> object). The
<code class="docutils literal"><span class="pre">IndigoObject.decomposedMoleculeScaffold</span></code> returns the full scaffold
(<code class="docutils literal"><span class="pre">Decomposer</span></code> object) or a submolecule which matches the given query
(<code class="docutils literal"><span class="pre">DecompositionItem</span></code> object).</p>
<p>Java, C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">deco</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">createDecomposer</span><span class="p">(</span><span class="n">scaf</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">deco_item1</span> <span class="p">=</span> <span class="n">decomposer</span><span class="p">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">mol1</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="p">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;molrgoups1.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="p">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;highlighted1.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="p">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;scaffold1.mol&quot;</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">deco_item2</span> <span class="p">=</span> <span class="n">decomposer</span><span class="p">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">mol2</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="p">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;molrgoups2.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="p">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;highlighted2.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="p">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;scaffold2.mol&quot;</span><span class="p">);</span>

<span class="n">IndigoObject</span> <span class="n">scaffold</span> <span class="p">=</span> <span class="n">deco</span><span class="p">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">();</span>
<span class="n">scaffold</span><span class="p">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;full_scaffold.mol&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">deco</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createDecomposer</span><span class="p">(</span><span class="n">scaf</span><span class="p">);</span>

<span class="n">deco_item1</span> <span class="o">=</span> <span class="n">decomposer</span><span class="o">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">mol1</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="o">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;molrgoups1.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="o">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;highlighted1.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item1</span><span class="o">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;scaffold1.mol&quot;</span><span class="p">);</span>

<span class="n">deco_item2</span> <span class="o">=</span> <span class="n">decomposer</span><span class="o">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">mol2</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="o">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;molrgoups2.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="o">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;highlighted2.mol&quot;</span><span class="p">);</span>
<span class="n">deco_item2</span><span class="o">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;scaffold2.mol&quot;</span><span class="p">);</span>

<span class="n">scaffold</span> <span class="o">=</span> <span class="n">deco</span><span class="o">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">();</span>
<span class="n">scaffold</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;full_scaffold.mol&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Note</strong>: There are possible situations when a given query molecule does
not match a next decomposition molecule. An exception is raised in that
case.</p>
<p>The <code class="docutils literal"><span class="pre">DecompositionItem</span></code> objects supports iterating matches since a
given query scaffold can have several embeddings. The
<code class="docutils literal"><span class="pre">IndigoObject.iterateDecompositions</span></code> returns the <code class="docutils literal"><span class="pre">DecompositionItem</span></code>
iterator. The full scaffold can be completed by an appropriate match.
The <code class="docutils literal"><span class="pre">IndigoObject.addDecomposition</span></code> (<code class="docutils literal"><span class="pre">Decomposer</span></code> object )method
accepts a <code class="docutils literal"><span class="pre">DecompositionItem</span></code> object and adds the current match to the
full scaffold. The following example shows the usage with iterating all
matches:</p>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="c1"># iterate over all the structures</span>
<span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">structures</span><span class="p">:</span>
   <span class="c1"># handle current molecule and handle exceptions</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">item</span> <span class="o">=</span> <span class="n">deco</span><span class="o">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="n">smiles</span><span class="p">))</span>
      <span class="c1"># iterate over all the decompositions</span>
      <span class="k">for</span> <span class="n">q_match</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">iterateDecompositions</span><span class="p">()</span>
         <span class="c1"># get decomposed molecules (current match)</span>
         <span class="n">rg_mol</span> <span class="o">=</span> <span class="n">q_match</span><span class="o">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">()</span>
         <span class="c1"># add current match</span>
         <span class="n">deco</span><span class="o">.</span><span class="n">addDecomposition</span><span class="p">(</span><span class="n">q_match</span><span class="p">)</span>

   <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
      <span class="c1"># error handlers</span>
</pre></div>
</div>
<p><strong>Note</strong>: There are two different types of input queries: - user defined
molecule with RGroups - simple query molecule, which can be passed from
the Scaffold Detection</p>
<p>In the first case the full scaffold equals to the user defined molecule
itself and it can not be changed during the RGroup Decomposition. In the
second case the full scaffold should be generated by the library, and it
will be returned by the <code class="docutils literal"><span class="pre">decomposedMoleculeScaffold</span></code> method. You can
load scaffold from a molfile. The SMILES format is not supported at the
moment.</p>
<p>The following example shows the usage user-defined scaffold:</p>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># prepare query scaffold (e.g. &#39;(R1)C1CCCC(R2)C1&#39;)</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadQueryMoleculeFromFile</span><span class="p">(</span><span class="s2">&quot;query_mol&quot;</span><span class="p">)</span>

<span class="c1"># init decomposition</span>
<span class="n">deco</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createDecomposer</span><span class="p">(</span><span class="n">scaffold</span><span class="p">)</span>

<span class="c1"># load molecule</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s1">&#39;NC1CCCC(O)C1&#39;</span><span class="p">)</span>

<span class="c1"># create deco item</span>
<span class="n">item</span> <span class="o">=</span> <span class="n">deco</span><span class="o">.</span><span class="n">decomposeMolecule</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="n">smiles</span><span class="p">))</span>

<span class="c1"># iterate over all the decompositions</span>
<span class="k">for</span> <span class="n">q_match</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">iterateDecompositions</span><span class="p">()</span>
   <span class="c1"># get decomposed molecule (current match)</span>
   <span class="n">rg_mol</span> <span class="o">=</span> <span class="n">q_match</span><span class="o">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">()</span>

   <span class="c1"># print molfile</span>
   <span class="k">print</span><span class="p">(</span><span class="n">rg_mol</span><span class="o">.</span><span class="n">molfile</span><span class="p">())</span>
</pre></div>
</div>
<p>In the example above there will be two matches: (R1)C1CCCC(R2)C1, R1=OH,
R2=NH2 (R1)C1CCCC(R2)C1, R1=NH2, R2=OH</p>
<p><strong>Note</strong>: the following code is deprecated:</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">deco</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">decomposeMolecules</span><span class="o">(</span><span class="n">scaf</span><span class="o">,</span> <span class="n">arr</span><span class="o">);</span>
<span class="n">deco</span><span class="o">.</span><span class="na">decomposedMoleculeHighlighted</span><span class="o">().</span><span class="na">saveMolfile</span><span class="o">(</span><span class="s">&quot;highlighted.mol&quot;</span><span class="o">);</span>
<span class="n">IndigoObject</span> <span class="n">scaffold</span> <span class="o">=</span> <span class="n">deco</span><span class="o">.</span><span class="na">decomposedMoleculeScaffold</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="o">:</span> <span class="n">deco</span><span class="o">.</span><span class="na">iterateDecomposedMolecules</span><span class="o">())</span>
   <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">decomposedMoleculeWithRGroups</span><span class="o">().</span><span class="na">molfile</span><span class="o">());</span>
</pre></div>
</div>
<p>C#:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">deco</span> <span class="p">=</span> <span class="n">indigo</span><span class="p">.</span><span class="n">decomposeMolecules</span><span class="p">(</span><span class="n">scaf</span><span class="p">,</span> <span class="n">arr</span><span class="p">);</span>
<span class="n">deco</span><span class="p">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">().</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s">&quot;highlighted.mol&quot;</span><span class="p">);</span>
<span class="n">IndigoObject</span> <span class="n">scaffold</span> <span class="p">=</span> <span class="n">deco</span><span class="p">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">();</span>
<span class="k">foreach</span> <span class="p">(</span><span class="n">IndigoObject</span> <span class="n">item</span> <span class="k">in</span> <span class="n">deco</span><span class="p">.</span><span class="n">iterateDecomposedMolecules</span><span class="p">())</span>
   <span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">().</span><span class="n">molfile</span><span class="p">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">deco</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">decomposeMolecules</span><span class="p">(</span><span class="n">scaf</span><span class="p">,</span> <span class="n">arr</span><span class="p">);</span>
<span class="n">deco</span><span class="o">.</span><span class="n">decomposedMoleculeHighlighted</span><span class="p">()</span><span class="o">.</span><span class="n">saveMolfile</span><span class="p">(</span><span class="s2">&quot;highlighted.mol&quot;</span><span class="p">);</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">deco</span><span class="o">.</span><span class="n">decomposedMoleculeScaffold</span><span class="p">();</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">deco</span><span class="o">.</span><span class="n">iterateDecomposedMolecules</span><span class="p">():</span>
   <span class="k">print</span> <span class="n">item</span><span class="o">.</span><span class="n">decomposedMoleculeWithRGroups</span><span class="p">()</span><span class="o">.</span><span class="n">molfile</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reaction-products-enumeration">
<h2>Reaction Products Enumeration<a class="headerlink" href="#reaction-products-enumeration" title="Permalink to this headline">¶</a></h2>
<p>General API for the combinatorial chemistry capabilities of Indigo. More examples can be found <a class="reference external" href="../concepts/combichem.html">here</a>. Also some examples available at <a class="reference external" href="../options/reaction-product-enumeration.html">options</a> page.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadQueryReaction</span><span class="o">(</span><span class="s">&quot;Cl[C:1]([*:3])=O.[OH:2][*:4]&gt;&gt;[*:4][O:2][C:1]([*:3])=O&quot;</span><span class="o">);</span>
<span class="n">IndigoObject</span> <span class="n">monomers_table</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">createArray</span><span class="o">();</span>

<span class="n">monomers_table</span><span class="o">.</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">indigo</span><span class="o">.</span><span class="na">createArray</span><span class="o">());</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="na">at</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">indigo</span><span class="o">.</span><span class="na">loadMolecule</span><span class="o">(</span><span class="s">&quot;CC(Cl)=O&quot;</span><span class="o">));</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="na">at</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">indigo</span><span class="o">.</span><span class="na">loadMolecule</span><span class="o">(</span><span class="s">&quot;OC1CCC(CC1)C(Cl)=O&quot;</span><span class="o">));</span>

<span class="n">monomers_table</span><span class="o">.</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">indigo</span><span class="o">.</span><span class="na">createArray</span><span class="o">());</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="na">at</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">arrayAdd</span><span class="o">(</span><span class="n">indigo</span><span class="o">.</span><span class="na">loadMolecule</span><span class="o">(</span><span class="s">&quot;O[C@H]1[C@H](O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O&quot;</span><span class="o">));</span>

<span class="n">IndigoObject</span> <span class="n">output_reactions</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">reactionProductEnumerate</span><span class="o">(</span><span class="n">reaction</span><span class="o">,</span> <span class="n">monomers_table</span><span class="o">);</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">reaction</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadQueryReaction</span><span class="p">(</span><span class="s2">&quot;Cl[C:1]([*:3])=O.[OH:2][*:4]&gt;&gt;[*:4][O:2][C:1]([*:3])=O&quot;</span><span class="p">)</span>

<span class="n">monomers_table</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">()</span>

<span class="n">monomers_table</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">())</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;CC(Cl)=O&quot;</span><span class="p">))</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;OC1CCC(CC1)C(Cl)=O&quot;</span><span class="p">))</span>

<span class="n">monomers_table</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">())</span>
<span class="n">monomers_table</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;O[C@H]1[C@H](O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O&quot;</span><span class="p">))</span>

<span class="n">output_reactions</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">reactionProductEnumerate</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">monomers_table</span><span class="p">)</span>

<span class="n">indigo</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="s2">&quot;render-comment&quot;</span><span class="p">,</span> <span class="s2">&quot;Results&quot;</span><span class="p">)</span>
<span class="n">rxn_array</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">createArray</span><span class="p">();</span>
<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">output_reactions</span><span class="o">.</span><span class="n">iterateArray</span><span class="p">():</span>
    <span class="n">rxn</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">clone</span><span class="p">();</span>
    <span class="n">rxn_array</span><span class="o">.</span><span class="n">arrayAdd</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>

<span class="n">indigoRenderer</span><span class="o">.</span><span class="n">renderGridToFile</span><span class="p">(</span><span class="n">rxn_array</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;result_rpe.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/indigorenderer_8ea7fcead360b2449a4ba6fc1941fc59b5654ca4rpe.svg"><img alt="../../_images/indigorenderer_8ea7fcead360b2449a4ba6fc1941fc59b5654ca4rpe.svg" src="../../_images/indigorenderer_8ea7fcead360b2449a4ba6fc1941fc59b5654ca4rpe.svg" /></a>
<div class="section" id="reaction-based-molecule-transformations">
<h3>Reaction-based Molecule Transformations<a class="headerlink" href="#reaction-based-molecule-transformations" title="Permalink to this headline">¶</a></h3>
<p>Usage examples are available <a class="reference external" href="../concepts/transformation.html">here</a>.</p>
<p>Java:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">IndigoObject</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadQueryReaction</span><span class="o">(</span><span class="s">&quot;[*+:1][*-:2]&gt;&gt;[*:2]=[*:1]&quot;</span><span class="o">);</span>
<span class="n">IndigoObject</span> <span class="n">molecule</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="na">loadMolecule</span><span class="o">(</span><span class="s">&quot;[O-][C+]1CCCC1[N+]([O-])=O&quot;</span><span class="o">);</span>
<span class="n">indigo</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="n">reaction</span><span class="o">,</span> <span class="n">molecule</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">molecule</span><span class="o">.</span><span class="na">smiles</span><span class="o">());</span>
</pre></div>
</div>
<p>Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">reaction</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadQueryReaction</span><span class="p">(</span><span class="s2">&quot;[*+:1][*-:2]&gt;&gt;[*:2]=[*:1]&quot;</span><span class="p">)</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">indigo</span><span class="o">.</span><span class="n">loadMolecule</span><span class="p">(</span><span class="s2">&quot;[O-][C+]1CCCC1[N+]([O-])=O&quot;</span><span class="p">)</span>
<span class="n">indigo</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">smiles</span><span class="p">())</span>
</pre></div>
</div>
<div class="line"><br /></div>
Output:<div class="output highlight-default"><div class="highlight"><pre><span></span><span class="n">O</span><span class="o">=</span><span class="n">N</span><span class="p">(</span><span class="n">C1CCCC1</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="o">=</span><span class="n">O</span>
</pre></div>
</div>
</div>
</div>
</div>


                            </div>
                        </div>
                    </div>
                </section>
                
            </main>
        </div>

        <footer>
    <div class="uui-promo-footer">
        <div class="footer-logo-copyright">
            <div class="epam-logo">
                <img src="../../_static/images/Logo_Epam_Color.svg" alt="" />
            </div>
            <p class="copyright">© 2017, EPAM Systems. All Rights Reserved.</p>
        </div>
        <div class="footer-navigation">
            <ul class="uui-footer-navigation">
                <li><a href="../../index.html">Products</a></li>
                <li><a href="../../resources.html">Resources</a></li>
                <li><a href="../../download/index.html">Downloads</a></li>
                <li><a href="../../contact.html">Contact Info</a></li>
            </ul>
        </div>
    </div>
</footer>
    </div>
    
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20662471-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
    
</body>
</html>